# 🏭 Anajak ERP Flow Redesign - Complete Factory System

## 📋 สารบัญ

### Core Systems
1. [ภาพรวมระบบ](#ภาพรวมระบบ)
2. [Factory Capabilities](#factory-capabilities)
3. [Product Types & Workflow](#product-types--workflow)
4. [Order Creation Flow](#order-creation-flow)
5. [Design & Approval Workflow](#design--approval-workflow)
6. [Production Pipeline](#production-pipeline)
7. [Outsource System](#outsource-system)
8. [Addon System](#addon-system)

### Operations
9. [Issue & Error Tracking](#issue--error-tracking)
10. [Status Reversion System](#status-reversion-system)
11. [Material Procurement](#material-procurement)
12. [Change Request Management](#change-request-management)
13. [Quality Control](#quality-control)

### Finance & Documents ⭐ NEW
14. [Quotation System](#quotation-system)
15. [Invoice & Payment](#invoice--payment)
16. [Pricing Engine](#pricing-engine)

### Delivery & Customer ⭐ NEW
17. [Shipping & Delivery](#shipping--delivery)
18. [Customer Portal](#customer-portal)
19. [Repeat Order System](#repeat-order-system)

### Communication & Reports ⭐ NEW
20. [Notification System](#notification-system)
21. [Reports & Analytics](#reports--analytics)
22. [Production Calendar](#production-calendar)

### Technical
23. [Database Schema Updates](#database-schema-updates)
24. [Implementation Roadmap](#implementation-roadmap)

---

## 🎯 ภาพรวมระบบ

### ปัญหาปัจจุบัน
- ❌ ไม่มีการแยกประเภทสินค้า (เสื้อสำเร็จรูป vs ตัดเย็บ)
- ❌ Addon ไม่ได้แยกเป็นระบบชัดเจน
- ❌ Change Request ไม่มี workflow ที่เข้มงวด
- ❌ Dependencies ระหว่างขั้นตอนไม่ชัดเจน
- ❌ ไม่มี approval gates ที่บังคับ

### เป้าหมายใหม่
- ✅ รองรับทุกประเภทการผลิต
- ✅ Addon แยกเป็น module ที่ flexible
- ✅ Change Request มี cost tracking และ approval
- ✅ Production Dependencies อัตโนมัติ
- ✅ Mandatory Approval Gates ก่อนผลิต
- ✅ รองรับ In-house expansion ในอนาคต
- ✅ Issue/Error Tracking สำหรับความผิดพลาด
- ✅ Status Reversion ย้อนสถานะได้
- ✅ Material Procurement สำหรับของที่ไม่มี Stock

---

## 🏭 Factory Capabilities

### Current State: DTF Only Factory

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    FACTORY CAPABILITIES CONFIG                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 ความสามารถปัจจุบันของโรงงาน (Configurable - ขยายได้ในอนาคต)                    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  ✅ IN-HOUSE CAPABILITIES (ทำเองได้)                                   │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  🖨️ DTF Printing        ✅ Active     Capacity: 200 pcs/day           │    │
│   │  📋 Design Services     ✅ Active     (ออกแบบลาย)                      │    │
│   │  📦 Final Assembly      ✅ Active     (รวม+แพ็ค)                       │    │
│   │  🔍 Quality Control     ✅ Active     (ตรวจคุณภาพ)                     │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  📤 OUTSOURCE REQUIRED (ต้องส่งนอก)                                    │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  👕 Garment (เสื้อผ้า)                                                  │    │
│   │  ├─ เสื้อสำเร็จรูป        → Stock / สั่งจาก Supplier                    │    │
│   │  ├─ ตัดผ้า (Cutting)     → โรงตัด                                      │    │
│   │  └─ ตัดเย็บ (Sewing)     → โรงเย็บ                                     │    │
│   │                                                                        │    │
│   │  🖨️ Other Printing                                                     │    │
│   │  ├─ DTG                  → ร้านสกรีน DTG                               │    │
│   │  ├─ Silkscreen           → โรงสกรีนซิลค์                                │    │
│   │  ├─ Sublimation          → ร้านซับลิเมชั่น                              │    │
│   │  └─ Vinyl                → ร้านไวนิล                                   │    │
│   │                                                                        │    │
│   │  🧵 Embroidery                                                         │    │
│   │  └─ งานปักทุกประเภท       → โรงปัก                                      │    │
│   │                                                                        │    │
│   │  🏷️ Labels & Tags                                                      │    │
│   │  ├─ ป้ายทอ               → โรงทอป้าย                                   │    │
│   │  ├─ ป้ายพิมพ์             → โรงพิมพ์ป้าย                                 │    │
│   │  ├─ ป้ายหนัง             → ร้านทำป้ายหนัง                               │    │
│   │  └─ Hang Tag             → โรงพิมพ์                                    │    │
│   │                                                                        │    │
│   │  📦 Packaging                                                          │    │
│   │  ├─ กล่องพิมพ์            → โรงพิมพ์บรรจุภัณฑ์                           │    │
│   │  ├─ ถุงกระดาษพิมพ์        → โรงพิมพ์                                    │    │
│   │  └─ ถุง OPP/Zipper      → Stock (สั่งเข้า)                             │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  🔮 FUTURE EXPANSION (ขยายในอนาคต)                                     │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  เมื่อซื้อเครื่องใหม่ → เปิด capability ในระบบ → งานเข้าคิว in-house     │    │
│   │                                                                        │    │
│   │  🔲 DTG Printing        ⏸️ Planned    (รอซื้อเครื่อง)                   │    │
│   │  🔲 Embroidery          ⏸️ Planned    (รอซื้อเครื่องปัก)                │    │
│   │  🔲 Silkscreen          ⏸️ Planned    (รอตั้ง line)                    │    │
│   │  🔲 Cutting             ⏸️ Planned    (รอซื้อเครื่องตัด)                │    │
│   │  🔲 Sewing              ⏸️ Planned    (รอจ้างช่าง)                     │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Capability Management UI

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  ⚙️ Factory Capabilities Settings                              [Admin Only]     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Work Type         │ Status      │ Capacity    │ Default Mode  │ Actions       │
│  ──────────────────┼─────────────┼─────────────┼───────────────┼───────────────│
│  DTF Printing      │ ✅ Active   │ 200/day     │ In-house      │ [Edit]        │
│  DTG Printing      │ ⏸️ Inactive │ -           │ Outsource     │ [Activate]    │
│  Silkscreen        │ ⏸️ Inactive │ -           │ Outsource     │ [Activate]    │
│  Embroidery        │ ⏸️ Inactive │ -           │ Outsource     │ [Activate]    │
│  Cutting           │ ⏸️ Inactive │ -           │ Outsource     │ [Activate]    │
│  Sewing            │ ⏸️ Inactive │ -           │ Outsource     │ [Activate]    │
│  Design            │ ✅ Active   │ ∞           │ In-house      │ [Edit]        │
│  QC                │ ✅ Active   │ ∞           │ In-house      │ -             │
│  Assembly          │ ✅ Active   │ 500/day     │ In-house      │ [Edit]        │
│                                                                                  │
│  [➕ Add Capability]                                                             │
│                                                                                  │
│  ⚠️ การเปิด Capability ใหม่:                                                     │
│  1. ซื้อเครื่อง/อุปกรณ์                                                          │
│  2. สร้าง Production Station ในระบบ                                             │
│  3. กำหนด Capacity                                                              │
│  4. งานใหม่จะเข้าคิว In-house อัตโนมัติ                                          │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Auto-Routing Logic

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    WORK ROUTING DECISION                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   เมื่อมี Work Item ใหม่:                                                         │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                         │   │
│   │   Work Item Created                                                     │   │
│   │        │                                                                │   │
│   │        ▼                                                                │   │
│   │   ┌─────────────────────────────────────────────────────────────────┐  │   │
│   │   │  Check Factory Capability for this Work Type                    │  │   │
│   │   └─────────────────────────────────────────────────────────────────┘  │   │
│   │        │                                                                │   │
│   │        ├── Capability = Active                                         │   │
│   │        │        │                                                       │   │
│   │        │        ▼                                                       │   │
│   │        │   ┌─────────────────────────────────────────────────────────┐ │   │
│   │        │   │  Check Current Load vs Capacity                        │ │   │
│   │        │   └─────────────────────────────────────────────────────────┘ │   │
│   │        │        │                                                       │   │
│   │        │        ├── Load < 80% Capacity                                │   │
│   │        │        │        │                                              │   │
│   │        │        │        ▼                                              │   │
│   │        │        │   🏠 Route to IN-HOUSE Queue                         │   │
│   │        │        │                                                       │   │
│   │        │        └── Load >= 80% Capacity                               │   │
│   │        │                 │                                              │   │
│   │        │                 ▼                                              │   │
│   │        │            ⚠️ Prompt: In-house (รอคิว) or Outsource?          │   │
│   │        │                                                                │   │
│   │        │                                                                │   │
│   │        └── Capability = Inactive                                       │   │
│   │                 │                                                       │   │
│   │                 ▼                                                       │   │
│   │            📤 Route to OUTSOURCE                                       │   │
│   │            → Select Supplier (default or manual)                       │   │
│   │            → Create PO draft                                           │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
│   ⚡ Manual Override: Admin สามารถเปลี่ยน routing ได้เสมอ                         │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🛍️ Product Types & Workflow

### 1. Production Modes (รูปแบบการผลิต)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    PRODUCTION MODES                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────┐   ┌──────────────────────┐   ┌─────────────────┐  │
│  │   READY-MADE (R)     │   │  CUSTOM SEWING (C)   │   │   FULL CUSTOM   │  │
│  │   เสื้อสำเร็จรูป        │   │   ตัดเย็บตามแบบ         │   │   ออกแบบ+ตัดเย็บ   │  │
│  ├──────────────────────┤   ├──────────────────────┤   ├─────────────────┤  │
│  │                      │   │                      │   │                 │  │
│  │  • ดึงจาก Stock      │   │  • สั่งผ้า/เลือกผ้า     │   │  • ออกแบบ Pattern │  │
│  │  • เลือก Size/Color  │   │  • ใช้ Pattern มี     │   │  • เลือกผ้า       │  │
│  │  • สกรีน/ปัก         │   │  • ตัด → เย็บ → สกรีน │   │  • ตัด → เย็บ    │  │
│  │  • ส่งมอบ            │   │  • QC → ส่งมอบ       │   │  • สกรีน/ปัก     │  │
│  │                      │   │                      │   │  • QC → ส่งมอบ  │  │
│  │  ⏱️ Lead: 3-5 วัน    │   │  ⏱️ Lead: 7-14 วัน   │   │  ⏱️ Lead: 14-30 │  │
│  └──────────────────────┘   └──────────────────────┘   └─────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2. Work Categories (หมวดหมู่งาน)

| Category | Work Types | ต้องมี Design? | ต้องมี Material? |
|----------|------------|----------------|------------------|
| **PRINTING** | DTG, DTF, Silkscreen, Sublimation, Vinyl | ✅ ใช่ | ❌ (หมึก) |
| **EMBROIDERY** | Embroidery, Embroidery Badge | ✅ ใช่ | ❌ (ด้าย) |
| **GARMENT** | Pattern, Cutting, Sewing | ❌ (ใช้ Pattern) | ✅ ผ้า |
| **LABELING** | Woven Label, Printed Label, Leather Tag | ✅ ใช่ | ✅ (สั่งทำ) |
| **PACKAGING** | Hang Tag, Bag, Box, Fold Pack | ✅/❌ | ✅ |
| **FINISHING** | Wash, Press, Steam, Spray | ❌ | ❌ |

---

## 📝 Order Creation Flow

### Master Flow สำหรับสร้าง Order

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         ORDER CREATION MASTER FLOW                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   STEP 1: เลือกลูกค้า                                                            │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  🔍 ค้นหาลูกค้าเดิม  |  ➕ เพิ่มลูกค้าใหม่                                    │  │
│   │  Customer: [บริษัท ABC จำกัด              ▼]                              │  │
│   │  ประเภท: [Retail] [Wholesale] [Corporate] ← เลือก Tier = เลือก Pricing    │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│        │                                                                         │
│        ▼                                                                         │
│   STEP 2: เลือกรูปแบบการผลิต                                                      │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  ○ เสื้อสำเร็จรูป (Stock) ───→ ไปเลือก Product จาก Stock                   │  │
│   │  ○ ตัดเย็บตามแบบ ─────────→ เลือก Pattern + Fabric                        │  │
│   │  ○ ออกแบบ+ตัดเย็บใหม่ ────→ Design → Pattern → Fabric                     │  │
│   │  ○ งานสกรีน/ปักอย่างเดียว ─→ ลูกค้าส่งเสื้อมา                                │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│        │                                                                         │
│        ▼                                                                         │
│   STEP 3: กำหนด Order Items                                                      │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  📦 Order Items                                                           │  │
│   │  ├─ Item 1: เสื้อโปโล สีขาว                                                 │  │
│   │  │   ├─ Size: S(10), M(20), L(15), XL(5) = 50 ตัว                        │  │
│   │  │   ├─ งาน: [✓] สกรีน DTF หน้าอก  [✓] ปักโลโก้อก  [✓] ป้ายทอคอ           │  │
│   │  │   └─ Addons: [✓] Hang Tag  [✓] ถุง OPP                                 │  │
│   │  │                                                                        │  │
│   │  ├─ Item 2: เสื้อยืดคอกลม สีดำ                                              │  │
│   │  │   ├─ Size: M(30), L(20) = 50 ตัว                                       │  │
│   │  │   └─ งาน: [✓] สกรีน DTG หลัง                                            │  │
│   │  │                                                                        │  │
│   │  [➕ เพิ่ม Item]                                                           │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│        │                                                                         │
│        ▼                                                                         │
│   STEP 4: รายละเอียดการออกแบบ (ต่อ Item)                                          │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  🎨 Design Requirements                                                    │  │
│   │  ├─ งาน: สกรีน DTF หน้าอก                                                  │  │
│   │  │   ├─ ตำแหน่ง: หน้าอกซ้าย                                                 │  │
│   │  │   ├─ ขนาด: 8x8 cm                                                      │  │
│   │  │   ├─ ไฟล์อ้างอิง: [📎 upload file]                                      │  │
│   │  │   ├─ หมายเหตุ: "โลโก้ตามไฟล์ สีตามเสื้อ"                                  │  │
│   │  │   └─ [○ ลูกค้าส่งไฟล์พร้อมผลิต] [● ต้องออกแบบก่อน]                       │  │
│   │  │                                                                        │  │
│   │  ├─ งาน: ปักโลโก้อก                                                        │  │
│   │  │   ├─ ตำแหน่ง: อกขวา                                                     │  │
│   │  │   ├─ ขนาด: 5x3 cm                                                      │  │
│   │  │   └─ [● ลูกค้าส่งไฟล์พร้อมผลิต]                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│        │                                                                         │
│        ▼                                                                         │
│   STEP 5: Pricing & Payment                                                      │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  💰 สรุปราคา                                                               │  │
│   │  ├─ Item 1: 50 x ฿150 = ฿7,500                                            │  │
│   │  │   ├─ สกรีน: 50 x ฿25 = ฿1,250                                          │  │
│   │  │   ├─ ปัก: 50 x ฿30 = ฿1,500                                            │  │
│   │  │   ├─ ป้ายทอ: 50 x ฿5 = ฿250                                            │  │
│   │  │   └─ Addons: ฿200                                                      │  │
│   │  ├─ Item 2: 50 x ฿120 = ฿6,000                                            │  │
│   │  │   └─ สกรีน: 50 x ฿35 = ฿1,750                                          │  │
│   │  ├─ รวม: ฿18,450                                                          │  │
│   │  ├─ ส่วนลด: -฿450 (Tier discount)                                         │  │
│   │  └─ สุทธิ: ฿18,000                                                         │  │
│   │                                                                            │  │
│   │  💳 Payment Terms                                                          │  │
│   │  [○ ชำระเต็ม] [● มัดจำ 50%] [○ มัดจำ 30%] [○ เครดิต 30 วัน]                │  │
│   │                                                                            │  │
│   │  📅 Delivery                                                               │  │
│   │  กำหนดส่ง: [2024-12-20]  Priority: [○ ปกติ] [● เร่ง +20%] [○ ด่วนมาก +50%] │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│        │                                                                         │
│        ▼                                                                         │
│   STEP 6: Review & Create                                                        │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  📋 สรุป Order                                                             │  │
│   │  [บันทึกแบบร่าง]  [ส่งใบเสนอราคา]  [สร้าง Order (รอชำระ)]                  │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🎨 Design & Approval Workflow

### Mandatory Approval Gates

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    DESIGN & APPROVAL WORKFLOW                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Order Created                                                                  │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─── GATE 1: Design Ready ───────────────────────────────────────────────────┐│
│   │                                                                             ││
│   │  For each Design Work:                                                      ││
│   │  ┌───────────────────────────────────────────────────────────────────────┐ ││
│   │  │  ❓ ลูกค้าส่งไฟล์พร้อมผลิต?                                              │ ││
│   │  │      │                                                                 │ ││
│   │  │      ├── YES ──→ ✅ File Received ──→ Admin Verify ──→ Ready          │ ││
│   │  │      │                                                                 │ ││
│   │  │      └── NO ───→ 🎨 Design Assignment                                  │ ││
│   │  │                       │                                                │ ││
│   │  │                       ▼                                                │ ││
│   │  │                  Designer Works                                        │ ││
│   │  │                       │                                                │ ││
│   │  │                       ▼                                                │ ││
│   │  │              ┌─── Design Version 1 ───┐                               │ ││
│   │  │              │  📤 ส่งให้ลูกค้า Review  │                               │ ││
│   │  │              └────────────────────────┘                               │ ││
│   │  │                       │                                                │ ││
│   │  │           ┌───────────┼───────────┐                                   │ ││
│   │  │           ▼           ▼           ▼                                   │ ││
│   │  │       APPROVED    REVISION    REJECTED                                │ ││
│   │  │           │           │           │                                   │ ││
│   │  │           │           │           └──→ Cancel / Restart               │ ││
│   │  │           │           │                                               │ ││
│   │  │           │           └──→ [แก้ไข <= 2 ครั้ง Free]                     │ ││
│   │  │           │                      │                                    │ ││
│   │  │           │                      └──→ [แก้ไข > 2 ครั้ง = คิดเงินเพิ่ม]   │ ││
│   │  │           │                                  │                        │ ││
│   │  │           │                                  ▼                        │ ││
│   │  │           │◄────────── Version N Approved ───┘                        │ ││
│   │  │           │                                                           │ ││
│   │  │           ▼                                                           │ ││
│   │  │     🔒 DESIGN LOCKED                                                  │ ││
│   │  │     (ห้ามแก้หลังจากนี้ ยกเว้น Change Request)                            │ ││
│   │  │                                                                       │ ││
│   │  └───────────────────────────────────────────────────────────────────────┘ ││
│   │                                                                             ││
│   │  ⚠️ CANNOT PROCEED TO PRODUCTION UNTIL ALL DESIGNS APPROVED                ││
│   └─────────────────────────────────────────────────────────────────────────────┘│
│        │                                                                         │
│        ▼ (All Designs Approved)                                                  │
│        │                                                                         │
│   ┌─── GATE 2: Mockup Approval ─────────────────────────────────────────────────┐│
│   │                                                                             ││
│   │  🖼️ Create Mockup (ภาพจำลองบนเสื้อจริง)                                      ││
│   │      │                                                                      ││
│   │      ▼                                                                      ││
│   │  ┌───────────────────────────────────────────────────────────────────────┐ ││
│   │  │  Mockup Views:                                                        │ ││
│   │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐                     │ ││
│   │  │  │ [Front] │ │ [Back]  │ │ [Left]  │ │ [Right] │                     │ ││
│   │  │  │         │ │         │ │         │ │         │                     │ ││
│   │  │  │  Logo   │ │  Print  │ │ Sleeve  │ │         │                     │ ││
│   │  │  │   ●     │ │ ████    │ │   ▲     │ │         │                     │ ││
│   │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘                     │ ││
│   │  │                                                                       │ ││
│   │  │  รายละเอียด:                                                           │ ││
│   │  │  • เสื้อโปโล สีขาว Size S-XL                                            │ ││
│   │  │  • สกรีน DTF หน้าอกซ้าย 8x8cm                                          │ ││
│   │  │  • ปักโลโก้อกขวา 5x3cm                                                 │ ││
│   │  │  • ป้ายทอที่คอ                                                         │ ││
│   │  └───────────────────────────────────────────────────────────────────────┘ ││
│   │      │                                                                      ││
│   │      ▼                                                                      ││
│   │  📤 ส่งลูกค้า Approve                                                        ││
│   │      │                                                                      ││
│   │      ├── APPROVED ──→ 🔒 MOCKUP LOCKED ──→ Ready for Production            ││
│   │      │                                                                      ││
│   │      └── REVISION ──→ ปรับแก้ Mockup ──→ Re-submit                         ││
│   │                                                                             ││
│   │  ⚠️ CANNOT START PRODUCTION UNTIL MOCKUP APPROVED                          ││
│   │  ⚠️ ลูกค้าต้องกดปุ่มยืนยัน + ได้รับการแจ้งเตือนว่าแก้ไขหลังจากนี้มีค่าใช้จ่าย      ││
│   └─────────────────────────────────────────────────────────────────────────────┘│
│        │                                                                         │
│        ▼ (Mockup Approved)                                                       │
│        │                                                                         │
│   ┌─── GATE 3: Material Ready ──────────────────────────────────────────────────┐│
│   │                                                                             ││
│   │  📦 Check Material Availability:                                            ││
│   │                                                                             ││
│   │  ┌─────────────────────────────────────────────────────────────────────┐   ││
│   │  │ Material              Required    Stock    Status                   │   ││
│   │  ├─────────────────────────────────────────────────────────────────────┤   ││
│   │  │ เสื้อโปโล ขาว S         10         15       ✅ Ready                 │   ││
│   │  │ เสื้อโปโล ขาว M         20         25       ✅ Ready                 │   ││
│   │  │ เสื้อโปโล ขาว L         15         10       ⚠️ Short 5              │   ││
│   │  │ เสื้อโปโล ขาว XL         5          0       ❌ Out of Stock          │   ││
│   │  │ ป้ายทอ 50 pcs         50        100       ✅ Ready                 │   ││
│   │  └─────────────────────────────────────────────────────────────────────┘   ││
│   │                                                                             ││
│   │  Actions:                                                                   ││
│   │  [📦 Reserve Available Stock]  [📝 Create PO for Missing]                  ││
│   │                                                                             ││
│   │  ⚠️ CANNOT START PRODUCTION FOR ITEMS WITHOUT MATERIAL                     ││
│   │  (แต่งานที่มี Material พอ สามารถเริ่มก่อนได้)                                  ││
│   └─────────────────────────────────────────────────────────────────────────────┘│
│        │                                                                         │
│        ▼ (All Gates Passed)                                                      │
│        │                                                                         │
│   🚀 PRODUCTION READY                                                            │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🏭 Production Pipeline

### Work Dependencies (ลำดับการผลิต)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    PRODUCTION DEPENDENCIES                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   งานบางอย่างต้องทำก่อน-หลัง ระบบจะจัดลำดับอัตโนมัติ                                  │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                         │   │
│   │   MODE: Ready-Made (เสื้อสำเร็จรูป)                                       │   │
│   │                                                                         │   │
│   │   [Stock Reserved] ──→ [Printing] ──→ [Embroidery] ──→ [QC] ──→ [Pack] │   │
│   │         │                   ▲              ▲                            │   │
│   │         │                   │              │                            │   │
│   │         └───────────────────┴──────────────┘                            │   │
│   │                    (ทำ parallel ได้ถ้าไม่ชนกัน)                            │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                         │   │
│   │   MODE: Custom Sewing (ตัดเย็บตามแบบ)                                     │   │
│   │                                                                         │   │
│   │   [Fabric Ready]                                                        │   │
│   │         │                                                               │   │
│   │         ▼                                                               │   │
│   │   [CUTTING] ──────────────────────────────────────────────────┐        │   │
│   │         │                                                     │        │   │
│   │         ▼                                                     ▼        │   │
│   │   [SEWING] ──→ [Sublimation/Print Before Sew?] ◄── (บางงาน)   │        │   │
│   │         │                                                     │        │   │
│   │         ▼                                                     │        │   │
│   │   [Printing] ◄────────────────────────────────────────────────┘        │   │
│   │         │                                                               │   │
│   │         ▼                                                               │   │
│   │   [Embroidery]                                                          │   │
│   │         │                                                               │   │
│   │         ▼                                                               │   │
│   │   [Label Attach] (ป้ายทอ, แท็ก)                                          │   │
│   │         │                                                               │   │
│   │         ▼                                                               │   │
│   │   [QC] ──→ [Finishing] ──→ [Packing]                                   │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
│   Dependency Rules:                                                              │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │ Work Type          │ Must Complete First          │ Can Parallel With  │    │
│   ├────────────────────┼─────────────────────────────┼────────────────────┤    │
│   │ Cutting            │ Fabric Ready                 │ -                  │    │
│   │ Sewing             │ Cutting                      │ -                  │    │
│   │ Printing (DTG/DTF) │ Sewing (if custom)           │ Embroidery         │    │
│   │ Embroidery         │ Sewing (if custom)           │ Printing           │    │
│   │ Sublimation        │ Cutting (before sew)         │ -                  │    │
│   │ Label Attach       │ Sewing                       │ Printing           │    │
│   │ Finishing          │ All Print/Emb                │ -                  │    │
│   │ Packing            │ QC Passed                    │ -                  │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Production Queue Management

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    PRODUCTION QUEUE MANAGEMENT                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 Queue Priority Algorithm:                                                   │
│                                                                                  │
│   Score = (Base Priority) + (Due Date Factor) + (Customer Tier Factor)          │
│                                                                                  │
│   Base Priority:                                                                 │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  0 = Normal                                                               │  │
│   │  1 = Rush (+20% cost)                                                     │  │
│   │  2 = Urgent (+50% cost)                                                   │  │
│   │  3 = Emergency (+100% cost)                                               │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   Due Date Factor:                                                               │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  Overdue:       +5 (สีแดง)                                                 │  │
│   │  Due Today:     +3 (สีส้ม)                                                 │  │
│   │  Due Tomorrow:  +2 (สีเหลือง)                                              │  │
│   │  Due This Week: +1 (สีเขียว)                                               │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   Customer Tier Factor:                                                          │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  VIP:      +2                                                             │  │
│   │  Premium:  +1                                                             │  │
│   │  Regular:  +0                                                             │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   📊 Queue View Example:                                                         │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │  DTG Queue                                           Today: 150 capacity  │  │
│   ├──────────────────────────────────────────────────────────────────────────┤  │
│   │  # │ Job        │ Customer    │ Qty  │ Due     │ Score │ Status         │  │
│   ├───┼────────────┼─────────────┼──────┼─────────┼───────┼────────────────┤  │
│   │ 1 │ PJ-001     │ ABC Corp    │ 50   │ OVERDUE │ 8     │ 🔴 In Progress │  │
│   │ 2 │ PJ-005     │ XYZ Ltd     │ 30   │ Today   │ 6     │ ⏳ Queued      │  │
│   │ 3 │ PJ-003     │ DEF Inc     │ 100  │ Tomorrow│ 4     │ ⏳ Queued      │  │
│   │ 4 │ PJ-007     │ GHI Shop    │ 20   │ +3 days │ 2     │ ⏳ Queued      │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## �icing️ Outsource System

### ภาพรวมระบบ Outsource

งานบางอย่างต้องส่งไปทำที่ Supplier ภายนอก เช่น:
- **ป้ายทอ/ป้ายหนัง** - สั่งจากโรงงานทำป้าย
- **Hang Tag/กล่องพิมพ์** - โรงพิมพ์
- **งานปักพิเศษ** - โรงปักที่มีเครื่องพิเศษ
- **ซับลิเมชั่น** - (ถ้าไม่มีเครื่อง)
- **ตัดเย็บจำนวนมาก** - ส่งโรงเย็บ
- **ผ้าตัด** - ส่งตัดที่โรงตัด

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         OUTSOURCE SYSTEM OVERVIEW                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  PRODUCTION MODE (per Work Item / Addon)                               │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │   ● IN-HOUSE      ผลิตเองในโรงงาน                                       │    │
│   │   ● OUTSOURCE     ส่งทำที่ Supplier                                    │    │
│   │   ● HYBRID        บางส่วนทำเอง บางส่วน outsource                        │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  OUTSOURCE CAPABLE ITEMS                                               │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  📦 ALWAYS OUTSOURCE (ต้องสั่งทำเสมอ)                                    │    │
│   │  ├─ ป้ายทอ (Woven Label)        → โรงงานทำป้าย                         │    │
│   │  ├─ ป้ายหนัง (Leather Tag)      → โรงงานทำป้าย                         │    │
│   │  ├─ Hang Tag พิมพ์พิเศษ          → โรงพิมพ์                              │    │
│   │  ├─ กล่องพิมพ์/ถุงกระดาษพิมพ์     → โรงพิมพ์บรรจุภัณฑ์                     │    │
│   │  └─ Button/Zipper พิเศษ         → ร้านอุปกรณ์                           │    │
│   │                                                                        │    │
│   │  🔄 CONFIGURABLE (เลือกได้ตามสถานการณ์)                                  │    │
│   │  ├─ งานปัก                      → ทำเองได้ / ส่งโรงปัก                   │    │
│   │  ├─ ซับลิเมชั่น                  → ทำเองได้ / ส่งร้านซับ                  │    │
│   │  ├─ สกรีนซิลค์สกรีน              → ทำเองได้ / ส่งโรงสกรีน                 │    │
│   │  ├─ ตัดผ้า                      → ทำเองได้ / ส่งโรงตัด                   │    │
│   │  └─ ตัดเย็บ                     → ทำเองได้ / ส่งโรงเย็บ                  │    │
│   │                                                                        │    │
│   │  🏠 IN-HOUSE ONLY (ทำเองเท่านั้น)                                       │    │
│   │  ├─ DTG Printing                                                       │    │
│   │  ├─ DTF Printing                                                       │    │
│   │  ├─ QC                                                                 │    │
│   │  └─ Final Packing                                                      │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Supplier Management

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         SUPPLIER MANAGEMENT                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  📋 SUPPLIER DATABASE                                                  │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  Supplier Info:                                                        │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │ Code:     SUP-001                                                │ │    │
│   │  │ Name:     โรงงานป้ายทอ ABC                                        │ │    │
│   │  │ Type:     [✓] ป้ายทอ [✓] ป้ายพิมพ์ [ ] งานปัก                     │ │    │
│   │  │ Contact:  คุณสมชาย 081-xxx-xxxx                                   │ │    │
│   │  │ LINE:     @abc_label                                             │ │    │
│   │  │ Email:    order@abc-label.com                                    │ │    │
│   │  │ Address:  123 ถนนเพชรบุรี กรุงเทพฯ                                 │ │    │
│   │  │                                                                  │ │    │
│   │  │ Lead Time:     7 วัน (standard)                                  │ │    │
│   │  │ Min Order:     100 pcs                                           │ │    │
│   │  │ Payment:       เครดิต 30 วัน                                      │ │    │
│   │  │                                                                  │ │    │
│   │  │ Rating:        ⭐⭐⭐⭐☆ (4.2)                                      │ │    │
│   │  │ On-time Rate:  92%                                               │ │    │
│   │  │ Quality Rate:  97%                                               │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  📊 Supplier List View:                                                │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │ Supplier        │ Services          │ Lead  │ Rating │ Status   │ │    │
│   │  ├─────────────────┼───────────────────┼───────┼────────┼──────────┤ │    │
│   │  │ โรงงานป้ายทอ ABC │ ป้ายทอ, ป้ายพิมพ์   │ 7 วัน  │ 4.2 ⭐ │ Active   │ │    │
│   │  │ โรงพิมพ์ XYZ     │ Hang Tag, กล่อง   │ 5 วัน  │ 4.5 ⭐ │ Active   │ │    │
│   │  │ ร้านปัก 123     │ งานปัก            │ 3 วัน  │ 4.0 ⭐ │ Active   │ │    │
│   │  │ โรงเย็บ DEF     │ ตัดเย็บ           │ 14 วัน │ 3.8 ⭐ │ Active   │ │    │
│   │  │ ร้านซับ GHI     │ Sublimation       │ 2 วัน  │ 4.3 ⭐ │ Inactive │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  💰 SUPPLIER PRICING                                                   │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  Price List per Supplier + Work Type:                                  │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │ Supplier: โรงงานป้ายทอ ABC                                        │ │    │
│   │  ├──────────────────────────────────────────────────────────────────┤ │    │
│   │  │ Item                │ 100-499  │ 500-999  │ 1000+    │ Unit     │ │    │
│   │  ├─────────────────────┼──────────┼──────────┼──────────┼──────────┤ │    │
│   │  │ ป้ายทอ Standard      │ ฿5       │ ฿4       │ ฿3       │ /ชิ้น     │ │    │
│   │  │ ป้ายทอ HD           │ ฿8       │ ฿6       │ ฿5       │ /ชิ้น     │ │    │
│   │  │ ป้ายพิมพ์ Satin      │ ฿3       │ ฿2.5     │ ฿2       │ /ชิ้น     │ │    │
│   │  │ ป้ายหนัง            │ ฿15      │ ฿12      │ ฿10      │ /ชิ้น     │ │    │
│   │  │ ค่าแม่พิมพ์ (ครั้งแรก) │ ฿500     │ -        │ -        │ /แบบ     │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Outsource Workflow (PO System)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         OUTSOURCE WORKFLOW                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Order Item ที่ต้อง Outsource                                                    │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  STEP 1: Design Approved (ถ้ามี)                                        │   │
│   │  ─────────────────────────────────────────────────────────────────────  │   │
│   │  • ลูกค้า Approve design                                                │   │
│   │  • Export production file (AI, PDF, etc.)                               │   │
│   │  • ระบุ specifications ครบถ้วน                                           │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  STEP 2: Create Purchase Order (PO)                                     │   │
│   │  ─────────────────────────────────────────────────────────────────────  │   │
│   │                                                                         │   │
│   │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│   │  │  📄 PURCHASE ORDER                                                │ │   │
│   │  │  ─────────────────────────────────────────────────────────────    │ │   │
│   │  │  PO Number:    PO-2024-0001                                       │ │   │
│   │  │  Date:         2024-12-05                                         │ │   │
│   │  │  Supplier:     โรงงานป้ายทอ ABC                                    │ │   │
│   │  │  Linked Order: #ORD-2024-0123                                     │ │   │
│   │  │                                                                   │ │   │
│   │  │  Items:                                                           │ │   │
│   │  │  ┌───────────────────────────────────────────────────────────┐   │ │   │
│   │  │  │ # │ Description         │ Qty │ Unit Price │ Total       │   │ │   │
│   │  │  ├───┼─────────────────────┼─────┼────────────┼─────────────┤   │ │   │
│   │  │  │ 1 │ ป้ายทอ HD โลโก้ ABC  │ 500 │ ฿5         │ ฿2,500      │   │ │   │
│   │  │  │ 2 │ ค่าแม่พิมพ์          │ 1   │ ฿500       │ ฿500        │   │ │   │
│   │  │  ├───┴─────────────────────┴─────┴────────────┼─────────────┤   │ │   │
│   │  │  │                                      Total │ ฿3,000      │   │ │   │
│   │  │  └───────────────────────────────────────────────────────────┘   │ │   │
│   │  │                                                                   │ │   │
│   │  │  Due Date:     2024-12-12 (7 วัน)                                 │ │   │
│   │  │  Delivery:     รับเอง / ส่งมา                                      │ │   │
│   │  │                                                                   │ │   │
│   │  │  Attachments:                                                     │ │   │
│   │  │  📎 design-file.ai                                                │ │   │
│   │  │  📎 spec-sheet.pdf                                                │ │   │
│   │  │                                                                   │ │   │
│   │  │  [💾 Save Draft]  [📤 Send to Supplier]                           │ │   │
│   │  └───────────────────────────────────────────────────────────────────┘ │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  STEP 3: Send PO & Track Status                                         │   │
│   │  ─────────────────────────────────────────────────────────────────────  │   │
│   │                                                                         │   │
│   │  PO Status Flow:                                                        │   │
│   │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│   │  │                                                                   │ │   │
│   │  │  [DRAFT] ──→ [SENT] ──→ [CONFIRMED] ──→ [PRODUCING]              │ │   │
│   │  │                              │                │                   │ │   │
│   │  │                              │                ▼                   │ │   │
│   │  │                              │         [SHIPPED/READY]            │ │   │
│   │  │                              │                │                   │ │   │
│   │  │                              │                ▼                   │ │   │
│   │  │                              │          [RECEIVED]                │ │   │
│   │  │                              │                │                   │ │   │
│   │  │                              │                ▼                   │ │   │
│   │  │                              │          [QC CHECK]                │ │   │
│   │  │                              │           │      │                 │ │   │
│   │  │                              │           ▼      ▼                 │ │   │
│   │  │                    [CANCELLED] ◄─    [PASSED] [FAILED]            │ │   │
│   │  │                                          │        │               │ │   │
│   │  │                                          │        ▼               │ │   │
│   │  │                                          │    [RETURN/REDO]       │ │   │
│   │  │                                          │                        │ │   │
│   │  │                                          ▼                        │ │   │
│   │  │                                    [COMPLETED] ✅                  │ │   │
│   │  │                                                                   │ │   │
│   │  └───────────────────────────────────────────────────────────────────┘ │   │
│   │                                                                         │   │
│   │  Communication Log:                                                     │   │
│   │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│   │  │ 12/05 09:00 │ PO sent via LINE                                   │ │   │
│   │  │ 12/05 10:30 │ Supplier confirmed, start production               │ │   │
│   │  │ 12/08 14:00 │ Supplier: ทำเสร็จแล้ว พร้อมส่ง                       │ │   │
│   │  │ 12/09 10:00 │ Received 500 pcs                                   │ │   │
│   │  │ 12/09 11:00 │ QC: Passed (498/500, 2 defects)                    │ │   │
│   │  └───────────────────────────────────────────────────────────────────┘ │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  STEP 4: Receive & QC                                                   │   │
│   │  ─────────────────────────────────────────────────────────────────────  │   │
│   │                                                                         │   │
│   │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│   │  │  📦 GOODS RECEIVING                                               │ │   │
│   │  │  ─────────────────────────────────────────────────────────────    │ │   │
│   │  │  PO: PO-2024-0001                                                 │ │   │
│   │  │  Supplier: โรงงานป้ายทอ ABC                                        │ │   │
│   │  │  Expected: 500 pcs                                                │ │   │
│   │  │                                                                   │ │   │
│   │  │  Received:                                                        │ │   │
│   │  │  ┌─────────────────────────────────────────────────────────────┐ │ │   │
│   │  │  │ Received Qty:   [500    ]                                   │ │ │   │
│   │  │  │ Received Date:  [2024-12-09]                                │ │ │   │
│   │  │  │ Received By:    [Admin A ▼]                                 │ │ │   │
│   │  │  │ Delivery:       [○ รับเอง] [● ส่งมา] Tracking: EX123456789  │ │ │   │
│   │  │  └─────────────────────────────────────────────────────────────┘ │ │   │
│   │  │                                                                   │ │   │
│   │  │  QC Check:                                                        │ │   │
│   │  │  ┌─────────────────────────────────────────────────────────────┐ │ │   │
│   │  │  │ ☑ จำนวนครบ                                                   │ │ │   │
│   │  │  │ ☑ สีตรงตามตัวอย่าง                                            │ │ │   │
│   │  │  │ ☑ ขนาดถูกต้อง                                                │ │ │   │
│   │  │  │ ☑ คุณภาพการทอ/พิมพ์                                          │ │ │   │
│   │  │  │ ☐ ไม่มีตำหนิ (พบ 2 ชิ้นมีตำหนิ)                                │ │ │   │
│   │  │  │                                                              │ │ │   │
│   │  │  │ Passed: 498   Failed: 2                                     │ │ │   │
│   │  │  │ Photo: 📎 qc-photo-1.jpg, 📎 qc-photo-2.jpg                 │ │ │   │
│   │  │  └─────────────────────────────────────────────────────────────┘ │ │   │
│   │  │                                                                   │ │   │
│   │  │  Action:                                                          │ │   │
│   │  │  [○ Accept All]  [● Partial Accept]  [○ Reject & Return]         │ │   │
│   │  │                                                                   │ │   │
│   │  │  [✓ Mark as Completed]                                            │ │   │
│   │  └───────────────────────────────────────────────────────────────────┘ │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                         │
│        ▼                                                                         │
│   Items พร้อมใช้ในการผลิต / Assembly                                              │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Outsource Dashboard

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         OUTSOURCE DASHBOARD                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   📊 Overview                                           [Today: 2024-12-05]     │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  Active POs: 12        Awaiting Delivery: 5        Overdue: 2 🔴       │    │
│   │  This Month: ฿45,000   Pending Payment: ฿12,000                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ⏰ Awaiting Items (รอของเข้า)                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  PO         │ Supplier     │ Items        │ Due      │ Status         │    │
│   ├─────────────┼──────────────┼──────────────┼──────────┼────────────────┤    │
│   │ PO-2024-001 │ ป้ายทอ ABC   │ ป้ายทอ 500   │ 🔴 LATE  │ ⚠️ Producing   │    │
│   │ PO-2024-002 │ โรงพิมพ์ XYZ │ Hang Tag 200 │ 🟡 Today │ 🚚 Shipped     │    │
│   │ PO-2024-003 │ ร้านปัก 123  │ ปักโลโก้ 50  │ 🟢 +2d   │ ✅ Confirmed   │    │
│   │ PO-2024-004 │ โรงพิมพ์ XYZ │ กล่อง 100    │ 🟢 +5d   │ ⏳ Sent        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   📦 Recent Received (รับของล่าสุด)                                              │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  Date       │ PO          │ Items        │ Qty   │ QC     │ Action    │    │
│   ├─────────────┼─────────────┼──────────────┼───────┼────────┼───────────┤    │
│   │ Today 10:00 │ PO-2024-005 │ ป้ายซัก 1000 │ 1000  │ ⏳     │ [QC Now]  │    │
│   │ Yesterday   │ PO-2024-006 │ ป้ายทอ 200   │ 200   │ ✅ Pass │ -         │    │
│   │ 2024-12-03  │ PO-2024-007 │ Hang Tag 500 │ 495   │ ⚠️ Part│ [Reorder] │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   🔔 Alerts                                                                      │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  ⚠️ PO-2024-001 เลยกำหนด 2 วัน - ติดต่อ Supplier                        │    │
│   │  ⚠️ Order #123 รอ ป้ายทอ - ไม่สามารถ pack ได้                           │    │
│   │  💰 PO-2024-008 ถึงกำหนดชำระ 3 วัน                                       │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Integration with Orders

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    OUTSOURCE INTEGRATION WITH ORDERS                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Order View - แสดงสถานะ Outsource Items                                         │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  Order #ORD-2024-0123                                                  │    │
│   │  ─────────────────────────────────────────────────────────────────     │    │
│   │                                                                        │    │
│   │  📦 Work Items:                                                        │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │ #  │ Item                │ Mode     │ Status           │ ETA    │ │    │
│   │  ├────┼─────────────────────┼──────────┼──────────────────┼────────┤ │    │
│   │  │ 1  │ สกรีน DTF หน้า      │ 🏠 In-house│ ✅ Completed    │ -      │ │    │
│   │  │ 2  │ ปักโลโก้อก          │ 🏠 In-house│ 🔄 In Progress  │ -      │ │    │
│   │  │ 3  │ ป้ายทอคอ            │ 📤 Outsource│ 🚚 Shipping    │ Dec 12 │ │    │
│   │  │ 4  │ Hang Tag           │ 📤 Outsource│ ⏳ Producing   │ Dec 14 │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  🏷️ Addons:                                                            │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │ #  │ Addon              │ Mode     │ Status           │ ETA    │ │    │
│   │  ├────┼────────────────────┼──────────┼──────────────────┼────────┤ │    │
│   │  │ 1  │ ถุง OPP            │ 📦 Stock │ ✅ Ready         │ -      │ │    │
│   │  │ 2  │ กล่องพิมพ์โลโก้      │ 📤 Outsource│ 📝 PO Created │ Dec 15 │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  ⚠️ Order Blocked: รอ ป้ายทอ + Hang Tag ก่อน Pack                      │    │
│   │  📅 Estimated Completion: Dec 16 (หลังรับของ outsource ครบ)             │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   Auto-Actions:                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │  🔄 เมื่อ Design Approved:                                              │    │
│   │     → Auto-create PO draft สำหรับ items ที่ต้อง outsource               │    │
│   │                                                                        │    │
│   │  🔄 เมื่อ Outsource Items ครบ:                                          │    │
│   │     → Auto-move order to "Ready for Assembly"                          │    │
│   │     → Notify Assembly team                                             │    │
│   │                                                                        │    │
│   │  🔄 เมื่อ PO เลยกำหนด:                                                   │    │
│   │     → Auto-update order estimated date                                 │    │
│   │     → Notify Sales + Customer (if configured)                          │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🏷️ Addon System

### Addon Types & Configuration

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         ADDON SYSTEM                                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Addon = บริการ/สินค้าเสริมที่ไม่ใช่งานหลัก แต่ต้องทำก่อนส่งมอบ                       │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  ADDON CATEGORIES                                                      │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  📦 PACKAGING                                                          │    │
│   │  ├─ OPP Bag (ถุง OPP)          ฿2/pcs    ไม่ต้องออกแบบ                  │    │
│   │  ├─ Zipper Bag               ฿5/pcs    ไม่ต้องออกแบบ                  │    │
│   │  ├─ Paper Bag (ถุงกระดาษ)       ฿15/pcs   ออกแบบได้ (optional)          │    │
│   │  ├─ Box (กล่อง)                ฿25/pcs   ออกแบบได้ (optional)          │    │
│   │  └─ Gift Box (กล่องของขวัญ)     ฿50/pcs   ออกแบบได้                    │    │
│   │                                                                        │    │
│   │  🏷️ LABELING                                                           │    │
│   │  ├─ Hang Tag (แท็กห้อย)         ฿3/pcs    ต้องออกแบบ                    │    │
│   │  ├─ Care Label (ป้ายซัก)        ฿2/pcs    ต้องระบุข้อมูล                 │    │
│   │  ├─ Size Label (ป้ายไซส์)       ฿1/pcs    เลือก template               │    │
│   │  └─ Brand Label (ป้ายแบรนด์)    ฿3/pcs    ต้องออกแบบ                    │    │
│   │                                                                        │    │
│   │  📐 FOLDING & FINISHING                                                │    │
│   │  ├─ Fold & Pack (พับแพค)       ฿5/pcs    รวมใส่ถุง                     │    │
│   │  ├─ Press (รีด)               ฿3/pcs    -                            │    │
│   │  ├─ Steam (นึ่ง)               ฿5/pcs    -                            │    │
│   │  └─ Spray Treatment          ฿10/pcs   กันน้ำ/กันยับ                  │    │
│   │                                                                        │    │
│   │  🎁 EXTRA SERVICES                                                     │    │
│   │  ├─ Individual Pack (แยกใส่ถุง)  ฿2/pcs    พร้อมชื่อ/เบอร์               │    │
│   │  ├─ Size Sorting (แยกไซส์)     ฿50/lot   -                            │    │
│   │  ├─ Photo (ถ่ายรูปสินค้า)        ฿200/set  5-10 รูป                     │    │
│   │  └─ Sample (ทำตัวอย่าง)        ราคาพิเศษ   ก่อนสั่งผลิตจริง                │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   Addon Workflow:                                                                │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │   Production Complete ──→ Addon Queue ──→ Addon Processing ──→ Pack   │    │
│   │                               │                   │                    │    │
│   │                               ▼                   ▼                    │    │
│   │                         [Hang Tag Ready?]   [Bag Ready?]              │    │
│   │                         [Care Label OK?]    [Box Ready?]              │    │
│   │                               │                   │                    │    │
│   │                               └─────┬─────────────┘                    │    │
│   │                                     ▼                                  │    │
│   │                               Assembly Station                         │    │
│   │                               (รวมทุก addon เข้าด้วยกัน)                  │    │
│   │                                     │                                  │    │
│   │                                     ▼                                  │    │
│   │                                Final QC                                │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🚨 Issue & Error Tracking

### ระบบบันทึกปัญหาและความผิดพลาด

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    ISSUE & ERROR TRACKING SYSTEM                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 เป้าหมาย:                                                                   │
│   - บันทึกทุกปัญหาที่เกิดขึ้น (โรงงานเรา, Supplier, ลูกค้า)                         │
│   - Track ว่าใครรับผิดชอบ และแก้ไขอย่างไร                                         │
│   - คิดค่าใช้จ่ายเพิ่มเติม (ถ้ามี)                                                 │
│   - วิเคราะห์หาสาเหตุและป้องกัน                                                   │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  ISSUE SOURCES (แหล่งที่มาของปัญหา)                                     │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  🏠 INTERNAL (ความผิดพลาดของเรา)                                        │    │
│   │  ├─ พิมพ์ผิด/สกรีนผิด           → Rework หรือ ทำใหม่                     │    │
│   │  ├─ พิมพ์ไม่ได้คุณภาพ           → Rework หรือ ทำใหม่                     │    │
│   │  ├─ ใช้เสื้อผิดสี/ไซส์          → หาใหม่/สั่งใหม่                        │    │
│   │  ├─ ส่งไฟล์ผิด                 → แก้ไข + อาจเลื่อนกำหนด                  │    │
│   │  ├─ ตัดผ้าผิด (ถ้ามี)           → ตัดใหม่                               │    │
│   │  └─ แพ็คผิด/ส่งผิด             → แก้ไข + ค่าส่งเพิ่ม                    │    │
│   │                                                                        │    │
│   │  📤 SUPPLIER (ความผิดพลาดของ Supplier)                                  │    │
│   │  ├─ ของไม่ตรงสเปค             → Return/Redo                           │    │
│   │  ├─ คุณภาพไม่ผ่าน             → Return/Redo + Claim                   │    │
│   │  ├─ จำนวนไม่ครบ               → สั่งเพิ่ม/Claim                        │    │
│   │  ├─ ส่งช้ากว่ากำหนด            → เลื่อน Order Due + Claim              │    │
│   │  └─ ส่งผิด                    → Return + สั่งใหม่                     │    │
│   │                                                                        │    │
│   │  👤 CUSTOMER (จากลูกค้า)                                                │    │
│   │  ├─ ส่งไฟล์ผิด/ไม่ครบ          → รอไฟล์ใหม่ + เลื่อนกำหนด               │    │
│   │  ├─ เปลี่ยนใจ (Change Request) → ดู Change Request flow               │    │
│   │  ├─ ไม่ยืนยัน Mockup ตรงเวลา   → เลื่อนกำหนด                           │    │
│   │  ├─ ชำระเงินล่าช้า             → Hold Order                           │    │
│   │  └─ ข้อมูลผิดพลาด              → แก้ไข + อาจมีค่าใช้จ่าย               │    │
│   │                                                                        │    │
│   │  🌪️ EXTERNAL (ปัจจัยภายนอก)                                            │    │
│   │  ├─ ของหมด Stock              → สั่งเพิ่ม + เลื่อนกำหนด                │    │
│   │  ├─ เครื่องเสีย                → ซ่อม/ส่ง Outsource                    │    │
│   │  ├─ ไฟดับ/น้ำท่วม             → เลื่อนกำหนด                           │    │
│   │  └─ ขนส่งมีปัญหา              → ติดตาม + แจ้งลูกค้า                    │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Issue Recording Form

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  🚨 Report Issue                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Basic Info                                                            │     │
│  ├────────────────────────────────────────────────────────────────────────┤     │
│  │  Order:         [#ORD-2024-0123                    ▼]                  │     │
│  │  Work Item:     [สกรีน DTF หน้าอก                   ▼]                  │     │
│  │  PO (if any):   [PO-2024-0001                      ▼]                  │     │
│  │                                                                        │     │
│  │  Issue Type:                                                           │     │
│  │  [○ Production Error]  [● Quality Issue]  [○ Delay]  [○ Other]        │     │
│  │                                                                        │     │
│  │  Source:                                                               │     │
│  │  [○ Internal]  [● Supplier]  [○ Customer]  [○ External]               │     │
│  │                                                                        │     │
│  │  Supplier (if applicable): [โรงงานป้ายทอ ABC          ▼]              │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Issue Details                                                         │     │
│  ├────────────────────────────────────────────────────────────────────────┤     │
│  │  Title:                                                                │     │
│  │  [ป้ายทอสีไม่ตรง________________________________________________]     │     │
│  │                                                                        │     │
│  │  Description:                                                          │     │
│  │  [ป้ายทอที่ได้รับสีเขียวเข้มกว่าตัวอย่างที่ส่งไป________________        │     │
│  │   _____________________________________________________________]      │     │
│  │                                                                        │     │
│  │  Affected Quantity:  [200    ] / 500 total                            │     │
│  │                                                                        │     │
│  │  Severity:                                                             │     │
│  │  [○ Low - ไม่กระทบ Timeline]                                           │     │
│  │  [● Medium - กระทบบางส่วน]                                              │     │
│  │  [○ High - กระทบมาก ต้องแก้ด่วน]                                        │     │
│  │  [○ Critical - หยุดงานทั้งหมด]                                          │     │
│  │                                                                        │     │
│  │  Evidence:                                                             │     │
│  │  📎 photo_issue_1.jpg, 📎 photo_issue_2.jpg                            │     │
│  │  [+ Add Photo]                                                         │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Resolution Plan                                                       │     │
│  ├────────────────────────────────────────────────────────────────────────┤     │
│  │  Action:                                                               │     │
│  │  [● Return to Supplier - ส่งคืน]                                       │     │
│  │  [○ Rework - แก้ไข]                                                    │     │
│  │  [○ Redo - ทำใหม่]                                                     │     │
│  │  [○ Accept with Discount - รับไว้ ขอส่วนลด]                             │     │
│  │  [○ Write Off - ทิ้ง]                                                  │     │
│  │                                                                        │     │
│  │  Responsible Party:                                                    │     │
│  │  [● Supplier pays]  [○ We pay]  [○ Split]  [○ Customer pays]          │     │
│  │                                                                        │     │
│  │  Estimated Cost:     ฿ [1,000    ]                                    │     │
│  │  Timeline Impact:    [+ 3     ] days                                  │     │
│  │                                                                        │     │
│  │  Assign To:          [Admin B                      ▼]                  │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  [Cancel]                              [Save Draft]  [Submit Issue]             │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Issue Status Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    ISSUE STATUS FLOW                                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   [OPEN] ──→ [INVESTIGATING] ──→ [ACTION_PLANNED] ──→ [IN_PROGRESS]            │
│                                         │                    │                   │
│                                         │                    ▼                   │
│                                         │              [RESOLVED]               │
│                                         │                    │                   │
│                                         │                    ▼                   │
│                                         │              [VERIFIED] ✅             │
│                                         │                                        │
│                                         └──→ [ESCALATED] ──→ [Management Review]│
│                                                                                  │
│   [Any] ──→ [ON_HOLD] ──→ [Resume]                                              │
│   [Any] ──→ [CANCELLED] (ถ้าไม่ใช่ปัญหาจริง)                                      │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 Status Reversion System

### ระบบย้อนสถานะ

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    STATUS REVERSION SYSTEM                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 สถานการณ์ที่ต้องย้อนสถานะ:                                                   │
│   - ลูกค้าเปลี่ยนใจ/แก้ไข design หลังจาก approve แล้ว                             │
│   - พบปัญหาต้องย้อนกลับไปแก้ไข                                                   │
│   - QC ไม่ผ่าน ต้องทำใหม่                                                        │
│   - Supplier ส่งของผิด ต้องรอใหม่                                                │
│   - ต้อง Hold งานไว้ก่อน                                                         │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  REVERSION RULES                                                       │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  ✅ ALLOWED (ย้อนได้เลย)                                                │    │
│   │  ├─ Draft → (any previous)                                            │    │
│   │  ├─ Quoted → Draft                                                    │    │
│   │  ├─ Awaiting Payment → Draft/Quoted                                   │    │
│   │  └─ Designing → Draft/Quoted/Awaiting Payment                         │    │
│   │                                                                        │    │
│   │  ⚠️ NEEDS REASON (ต้องให้เหตุผล + อาจมีค่าใช้จ่าย)                       │    │
│   │  ├─ Mockup Approved → Designing                                       │    │
│   │  │   └─ ต้องสร้าง Change Request + อาจคิดเงิน                          │    │
│   │  ├─ In Production → (any previous)                                    │    │
│   │  │   └─ ต้องระบุ: งานที่ทำไปแล้วจะเป็นอย่างไร                            │    │
│   │  └─ QC Failed → Rework / Redo                                         │    │
│   │       └─ Auto-link กับ Issue                                          │    │
│   │                                                                        │    │
│   │  🔒 REQUIRES APPROVAL (ต้องได้รับอนุมัติ)                                │    │
│   │  ├─ Ready to Ship → (any)                                             │    │
│   │  │   └─ Manager approval + เหตุผล                                     │    │
│   │  ├─ Shipped → (กรณี return)                                           │    │
│   │  │   └─ ต้องมี Return process                                         │    │
│   │  └─ Completed → (กรณีพิเศษมาก)                                         │    │
│   │       └─ Manager + Finance approval                                   │    │
│   │                                                                        │    │
│   │  ❌ NOT ALLOWED                                                        │    │
│   │  └─ Cancelled → (any) - ต้องสร้าง Order ใหม่                           │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Status Reversion Form

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  🔄 Request Status Reversion                                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Order:           #ORD-2024-0123                                                │
│  Current Status:  [🟢 In Production]                                            │
│  Revert To:       [Designing                           ▼]                       │
│                                                                                  │
│  ⚠️ Warning: This order has items in production!                                │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Affected Items                                                        │     │
│  ├────────────────────────────────────────────────────────────────────────┤     │
│  │  Work Item          │ Current Status   │ Produced │ Action            │     │
│  ├─────────────────────┼──────────────────┼──────────┼───────────────────┤     │
│  │  สกรีน DTF หน้า      │ In Progress      │ 30/100   │ [○ Keep ● Discard]│     │
│  │  ป้ายทอ              │ PO Sent          │ -        │ [● Keep ○ Cancel] │     │
│  │  Hang Tag           │ Pending          │ -        │ [● Keep ○ Cancel] │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  Reason:                                                                        │
│  [● Customer Change Request]                                                    │
│  [○ Quality Issue Found]                                                        │
│  [○ Material Problem]                                                           │
│  [○ Internal Error]                                                             │
│  [○ Other: _______________]                                                     │
│                                                                                  │
│  Description:                                                                   │
│  [ลูกค้าต้องการเปลี่ยนสีโลโก้_________________________________________]          │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Impact Assessment                                                     │     │
│  ├────────────────────────────────────────────────────────────────────────┤     │
│  │  • งานที่ทำไปแล้ว 30 ตัว: จะ discard                                     │     │
│  │  • ค่าใช้จ่ายสูญเสีย: ฿900 (30 x ฿30)                                   │     │
│  │  • Timeline: เลื่อนไป +5 วัน                                            │     │
│  │  • Linked Change Request: CR-2024-0005                                 │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ☐ I understand the impact and confirm this reversion                           │
│  ☐ Link to Issue: [ISS-2024-0012                     ▼] (optional)             │
│  ☐ Notify customer about new timeline                                           │
│                                                                                  │
│  [Cancel]                                        [Request Approval]             │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Reversion History

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📜 Order #ORD-2024-0123 - Status History                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Date/Time          │ From            │ To              │ By      │ Reason      │
│  ────────────────────┼─────────────────┼─────────────────┼─────────┼─────────────│
│  2024-12-01 09:00   │ -               │ Draft           │ Admin A │ Created     │
│  2024-12-01 14:00   │ Draft           │ Quoted          │ Admin A │ -           │
│  2024-12-02 10:00   │ Quoted          │ Awaiting Payment│ System  │ Quote sent  │
│  2024-12-03 11:00   │ Awaiting Payment│ Designing       │ System  │ Payment OK  │
│  2024-12-05 15:00   │ Designing       │ Mockup Approved │ Customer│ Approved    │
│  2024-12-06 09:00   │ Mockup Approved │ In Production   │ Admin B │ Started     │
│  ────────────────────┼─────────────────┼─────────────────┼─────────┼─────────────│
│  🔄 2024-12-08 14:00│ In Production   │ Designing       │ Admin A │ CR-005      │
│                     │ (REVERSION)     │                 │         │ ลูกค้าแก้ไข   │
│  ────────────────────┼─────────────────┼─────────────────┼─────────┼─────────────│
│  2024-12-09 10:00   │ Designing       │ Mockup Approved │ Customer│ Re-approved │
│  2024-12-09 14:00   │ Mockup Approved │ In Production   │ Admin B │ Restarted   │
│  ...                │                 │                 │         │             │
│                                                                                  │
│  📊 Statistics:                                                                  │
│  • Total reversions: 1                                                          │
│  • Days delayed: +3                                                             │
│  • Extra cost: ฿1,200                                                           │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 📦 Material Procurement

### ระบบสั่งซื้อวัสดุที่ไม่มี Stock

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    MATERIAL PROCUREMENT SYSTEM                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 สถานการณ์:                                                                  │
│   - ลูกค้าสั่งเสื้อที่เราไม่ได้ stock ไว้                                          │
│   - Stock หมด ต้องสั่งเพิ่ม                                                      │
│   - ต้องการเสื้อพิเศษ (สี/รุ่น/ยี่ห้อเฉพาะ)                                        │
│   - สั่งผ้า/วัสดุสำหรับตัดเย็บ                                                    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  MATERIAL TYPES                                                        │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  📦 STOCK ITEMS (ปกติมี stock)                                         │    │
│   │  ├─ เสื้อยืด Cotton สีพื้น (ขาว, ดำ, กรม)                               │    │
│   │  ├─ เสื้อโปโล TC สีพื้น                                                 │    │
│   │  ├─ ถุง OPP ขนาดมาตรฐาน                                                │    │
│   │  └─ ถุงซิป                                                             │    │
│   │                                                                        │    │
│   │  🛒 ORDER-BASED (สั่งตาม Order)                                         │    │
│   │  ├─ เสื้อสีพิเศษ (ชมพู, เขียวมิ้นท์, etc.)                               │    │
│   │  ├─ เสื้อยี่ห้อพิเศษ (Uniqlo, etc.)                                     │    │
│   │  ├─ ผ้าสำหรับตัดเย็บ                                                   │    │
│   │  └─ อุปกรณ์พิเศษ (ซิป, กระดุมเฉพาะ)                                     │    │
│   │                                                                        │    │
│   │  🏭 OUTSOURCE MATERIALS (Supplier จัดหา)                               │    │
│   │  ├─ ป้ายทอ → Supplier ทำให้                                            │    │
│   │  ├─ Hang Tag → Supplier ทำให้                                         │    │
│   │  └─ กล่องพิมพ์ → Supplier ทำให้                                         │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Material Requirement Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    MATERIAL REQUIREMENT FLOW                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Order Created with Items                                                       │
│        │                                                                         │
│        ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  MATERIAL CHECK                                                         │   │
│   │  (ตรวจสอบวัสดุทุก item อัตโนมัติ)                                          │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                         │
│        ├── ✅ Available in Stock                                                │
│        │        │                                                                │
│        │        ▼                                                                │
│        │   [Reserve Stock] → Ready                                              │
│        │                                                                         │
│        ├── ⚠️ Partial Stock (บางส่วน)                                           │
│        │        │                                                                │
│        │        ▼                                                                │
│        │   [Reserve Available] + [Create Material Request for Rest]             │
│        │                                                                         │
│        ├── ❌ Not in Stock                                                       │
│        │        │                                                                │
│        │        ▼                                                                │
│        │   [Create Material Request]                                            │
│        │        │                                                                │
│        │        ├── Stock Item → Auto-create PO to default supplier             │
│        │        │                                                                │
│        │        └── Non-Stock Item → Manual selection required                  │
│        │                  │                                                      │
│        │                  ▼                                                      │
│        │             ┌─────────────────────────────────────────────────┐        │
│        │             │  Select Procurement Method:                     │        │
│        │             │  [○ Order from Supplier A (3 days, ฿120/pc)]   │        │
│        │             │  [○ Order from Supplier B (5 days, ฿100/pc)]   │        │
│        │             │  [○ Customer provides (ลูกค้าส่งมา)]             │        │
│        │             └─────────────────────────────────────────────────┘        │
│        │                                                                         │
│        └── 👤 Customer Provides (ลูกค้าส่งเสื้อมาเอง)                            │
│                 │                                                                │
│                 ▼                                                                │
│            [Mark as "Awaiting Customer Material"]                               │
│                 │                                                                │
│                 ▼                                                                │
│            [Receive & QC when arrived]                                          │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Material Request Dashboard

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📦 Material Requests                                                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  📊 Overview:                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  Pending: 5       Ordered: 3       In Transit: 2       Received: 8      │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│  ⏳ Pending Material Requests                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  MR#    │ Order      │ Item                   │ Qty │ Status   │ Action │    │
│  ├─────────┼────────────┼────────────────────────┼─────┼──────────┼────────┤    │
│  │ MR-001  │ ORD-0123   │ เสื้อยืด สีชมพู M       │ 50  │ ⏳ Pending│ [Order]│    │
│  │ MR-002  │ ORD-0124   │ เสื้อโปโล Uniqlo ขาว   │ 20  │ ⏳ Pending│ [Order]│    │
│  │ MR-003  │ ORD-0125   │ ผ้า Cotton 2 หลา       │ 1   │ ⏳ Pending│ [Order]│    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│  👤 Awaiting Customer Material                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  Order      │ Item                   │ Expected    │ Status             │    │
│  ├─────────────┼────────────────────────┼─────────────┼────────────────────┤    │
│  │ ORD-0126    │ เสื้อทีม (ลูกค้าส่งมา)    │ 2024-12-10  │ 🚚 Shipping        │    │
│  │ ORD-0127    │ เสื้อเก่า (มาแก้ไข)       │ 2024-12-08  │ ✅ Received 50/50  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│  🚚 In Transit                                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  PO#        │ Supplier    │ Items              │ ETA        │ Tracking  │    │
│  ├─────────────┼─────────────┼────────────────────┼────────────┼───────────┤    │
│  │ PO-0050     │ ร้านเสื้อ ABC │ เสื้อยืด 100 ตัว    │ Tomorrow   │ EX123456  │    │
│  │ PO-0051     │ ร้านผ้า XYZ  │ ผ้า Cotton 5 หลา   │ +3 days    │ FL789012  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│  [➕ Create Manual Request]  [📊 View Report]                                    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Order View - Material Status

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  Order #ORD-2024-0123 - Material Status                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  Material              │ Required │ Available │ Ordered │ Status        │    │
│  ├────────────────────────┼──────────┼───────────┼─────────┼───────────────┤    │
│  │  เสื้อยืด Cotton ขาว M  │ 50       │ 50        │ -       │ ✅ Reserved   │    │
│  │  เสื้อยืด Cotton ขาว L  │ 30       │ 20        │ 10      │ ⏳ Partial    │    │
│  │  เสื้อยืด สีชมพู M      │ 20       │ 0         │ 20      │ 🚚 In Transit │    │
│  │  ป้ายทอ                │ 100      │ -         │ 100     │ 🏭 Producing  │    │
│  │  Hang Tag             │ 100      │ -         │ 100     │ ⏳ PO Created │    │
│  │  ถุง OPP              │ 100      │ 100       │ -       │ ✅ Reserved   │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│  Overall Material Status: ⏳ Waiting for materials                              │
│  Estimated All Ready:     2024-12-12                                            │
│                                                                                  │
│  ⚠️ Production blocked until:                                                   │
│  • เสื้อยืด Cotton ขาว L (10 ตัว) - ETA: 2024-12-10                              │
│  • เสื้อยืด สีชมพู M - ETA: 2024-12-11                                            │
│                                                                                  │
│  [📦 View All POs]  [📝 Create Manual PO]                                        │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 Change Request Management

### Change Request System สำหรับลูกค้าเรื่องมาก

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    CHANGE REQUEST MANAGEMENT                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 เป้าหมาย:                                                                   │
│   - ป้องกันการแก้ไขแบบไม่จำกัด                                                    │
│   - Track ค่าใช้จ่ายจากการแก้ไข                                                   │
│   - บันทึกประวัติทุกการเปลี่ยนแปลง                                                 │
│   - ให้ลูกค้าเห็นว่าแก้กี่ครั้ง มีค่าใช้จ่ายเท่าไร                                    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  CHANGE REQUEST PHASES                                                 │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  PHASE 1: Before Mockup Approval (ก่อนอนุมัติ Mockup)                   │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │  ✅ แก้ไขได้ฟรี 2 ครั้ง (Free Revisions)                           │ │    │
│   │  │  💰 ครั้งที่ 3+ คิด ฿100/ครั้ง (Minor Change)                       │ │    │
│   │  │  💰 เปลี่ยนแบบทั้งหมด คิด ฿300+ (Major Change)                     │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  PHASE 2: After Mockup Approval (หลังอนุมัติ Mockup)                   │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │  ⚠️ ต้องทำ Change Request                                         │ │    │
│   │  │  💰 ค่าดำเนินการ ฿200                                              │ │    │
│   │  │  💰 + ค่าออกแบบใหม่ (ถ้ามี)                                         │ │    │
│   │  │  ⏱️ + เลื่อนกำหนดส่ง                                               │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  PHASE 3: In Production (ระหว่างผลิต)                                  │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │  ⛔ ไม่สามารถแก้ไขงานที่ผลิตไปแล้ว                                   │ │    │
│   │  │  💰 งานที่ยังไม่ผลิต: ฿500 + ค่าออกแบบ + เลื่อนกำหนด                  │ │    │
│   │  │  💰 งานที่ผลิตแล้ว: ต้องทำใหม่ = คิดราคาเต็ม                          │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   │  PHASE 4: QC Complete (ผ่าน QC แล้ว)                                   │    │
│   │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│   │  │  ⛔ ไม่รับแก้ไข                                                     │ │    │
│   │  │  💰 ถ้าจะทำใหม่ = สั่ง Order ใหม่                                   │ │    │
│   │  └──────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   Change Request Workflow:                                                       │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │   Customer Request Change                                              │    │
│   │          │                                                             │    │
│   │          ▼                                                             │    │
│   │   ┌─────────────────────────────────────────────────────────────────┐ │    │
│   │   │  CHANGE REQUEST FORM                                            │ │    │
│   │   ├─────────────────────────────────────────────────────────────────┤ │    │
│   │   │  Order: #ORD-2024-0123                                          │ │    │
│   │   │  Current Phase: [In Production]                                 │ │    │
│   │   │                                                                 │ │    │
│   │   │  What to Change:                                                │ │    │
│   │   │  [✓] Design/Artwork                                             │ │    │
│   │   │  [ ] Quantity                                                   │ │    │
│   │   │  [ ] Size Distribution                                          │ │    │
│   │   │  [ ] Color                                                      │ │    │
│   │   │  [ ] Add/Remove Work                                            │ │    │
│   │   │                                                                 │ │    │
│   │   │  Description:                                                   │ │    │
│   │   │  [ต้องการเปลี่ยนสีโลโก้จากแดงเป็นน้ำเงิน________________]        │ │    │
│   │   │                                                                 │ │    │
│   │   │  Attachments: [📎 new_logo.png]                                 │ │    │
│   │   │                                                                 │ │    │
│   │   │  ⚠️ Cost Estimate:                                              │ │    │
│   │   │  • ค่าดำเนินการ Change Request: ฿500                            │ │    │
│   │   │  • ค่าออกแบบใหม่: ฿300                                          │ │    │
│   │   │  • งานที่ผลิตไปแล้ว 30 ตัว ต้องทำใหม่: ฿900                       │ │    │
│   │   │  • รวม: ฿1,700                                                  │ │    │
│   │   │  • กำหนดส่งใหม่: +3 วัน                                          │ │    │
│   │   │                                                                 │ │    │
│   │   │  [Submit Request]                                               │ │    │
│   │   └─────────────────────────────────────────────────────────────────┘ │    │
│   │          │                                                             │    │
│   │          ▼                                                             │    │
│   │   Admin Review                                                         │    │
│   │          │                                                             │    │
│   │          ├── Approve ──→ Generate Invoice ──→ Customer Pays ──→ Start │    │
│   │          │                                                             │    │
│   │          ├── Negotiate ──→ Adjust Quote ──→ Customer Confirm          │    │
│   │          │                                                             │    │
│   │          └── Reject ──→ Explain Why ──→ Continue Original              │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   Change History (ประวัติการแก้ไข - แสดงให้ลูกค้าเห็น):                             │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  Order #ORD-2024-0123 - Change History                                 │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │  #  │ Date       │ Type           │ Status   │ Cost    │ New Due      │    │
│   ├────┼────────────┼────────────────┼──────────┼─────────┼──────────────┤    │
│   │  1 │ 2024-12-01 │ Design Rev #1  │ ✅ Free  │ ฿0      │ -            │    │
│   │  2 │ 2024-12-02 │ Design Rev #2  │ ✅ Free  │ ฿0      │ -            │    │
│   │  3 │ 2024-12-03 │ Design Rev #3  │ ✅ Paid  │ ฿100    │ -            │    │
│   │  4 │ 2024-12-05 │ Color Change   │ ✅ Paid  │ ฿500    │ +2 days      │    │
│   │  5 │ 2024-12-08 │ Add 20 pcs     │ ✅ Paid  │ ฿600    │ +1 day       │    │
│   ├────┴────────────┴────────────────┴──────────┴─────────┴──────────────┤    │
│   │  Total Change Cost: ฿1,200        Total Delay: +3 days               │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## ✅ Quality Control

### Multi-Stage QC System

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    QUALITY CONTROL SYSTEM                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 QC Stages (ตรวจหลายจุด ไม่ใช่รอตอนสุดท้าย):                                   │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │   STAGE 1: Material QC (ตรวจวัตถุดิบ)                                   │    │
│   │   ────────────────────────────────────────────────────────────────     │    │
│   │   เมื่อ: สินค้าเข้า Stock / Supplier ส่งของ                               │    │
│   │   ตรวจ: จำนวน, สี, คุณภาพผ้า, ขนาด                                       │    │
│   │   ผล: Accept / Reject / Partial Accept                                 │    │
│   │                                                                        │    │
│   │   STAGE 2: Pre-Production QC (ก่อนผลิต)                                 │    │
│   │   ────────────────────────────────────────────────────────────────     │    │
│   │   เมื่อ: เตรียมงานก่อนเข้าเครื่อง                                          │    │
│   │   ตรวจ: ไฟล์ถูกต้อง, เสื้อพร้อม, วัสดุพร้อม                                 │    │
│   │   ผล: Ready / Not Ready                                                │    │
│   │                                                                        │    │
│   │   STAGE 3: In-Process QC (ระหว่างผลิต)                                  │    │
│   │   ────────────────────────────────────────────────────────────────     │    │
│   │   เมื่อ: ทุก X ตัว หรือเมื่อเปลี่ยน batch                                   │    │
│   │   ตรวจ: ตามเช็คลิสต์ของ work type                                       │    │
│   │   ผล: Continue / Adjust / Stop                                         │    │
│   │                                                                        │    │
│   │   STAGE 4: Post-Production QC (หลังผลิตแต่ละงาน)                        │    │
│   │   ────────────────────────────────────────────────────────────────     │    │
│   │   เมื่อ: งานเสร็จ ก่อนไป process ถัดไป                                    │    │
│   │   ตรวจ: ตามเช็คลิสต์ + ถ่ายรูป                                           │    │
│   │   ผล: Pass / Fail → Rework                                             │    │
│   │                                                                        │    │
│   │   STAGE 5: Final QC (ก่อนส่งลูกค้า)                                      │    │
│   │   ────────────────────────────────────────────────────────────────     │    │
│   │   เมื่อ: ทุกงานเสร็จ รวม addon แล้ว                                       │    │
│   │   ตรวจ: ภาพรวมทั้งหมด, จำนวน, การแพ็ค                                    │    │
│   │   ผล: Ready to Ship / Hold                                             │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   QC Checklist by Work Type:                                                     │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │  DTG/DTF Printing:                                                     │    │
│   │  ☐ สีถูกต้องตาม Mockup (Color Accuracy)                                 │    │
│   │  ☐ ตำแหน่งลายถูกต้อง (Position)                                         │    │
│   │  ☐ ลายคมชัด ไม่เบลอ (Print Quality)                                     │    │
│   │  ☐ ไม่มีจุดขาว/จุดดำ (No Defects)                                       │    │
│   │  ☐ ไม่มีรอยเปื้อน (No Stains)                                           │    │
│   │  ☐ ไม่มีรอยยับ (No Wrinkles)                                           │    │
│   │                                                                        │    │
│   │  Embroidery:                                                           │    │
│   │  ☐ สีด้ายถูกต้อง (Thread Color)                                         │    │
│   │  ☐ ฝีเข็มสม่ำเสมอ (Stitch Quality)                                      │    │
│   │  ☐ ตำแหน่งถูกต้อง (Position)                                            │    │
│   │  ☐ ขนาดถูกต้อง (Size)                                                  │    │
│   │  ☐ ด้านหลังสะอาด (Backing Clean)                                       │    │
│   │  ☐ ไม่มีด้ายหลุด (No Loose Threads)                                     │    │
│   │                                                                        │    │
│   │  Silkscreen:                                                           │    │
│   │  ☐ หมึกทึบสม่ำเสมอ (Ink Coverage)                                       │    │
│   │  ☐ สีไม่เยื้อง (Registration)                                           │    │
│   │  ☐ ไม่มีหมึกเลอะ (Clean Print)                                          │    │
│   │  ☐ ลายติดแน่น (Ink Adhesion)                                           │    │
│   │                                                                        │    │
│   │  Sewing:                                                               │    │
│   │  ☐ ไซส์ตรงตามกำหนด (Size Accuracy)                                      │    │
│   │  ☐ รอยเย็บเรียบร้อย (Seam Quality)                                      │    │
│   │  ☐ ไม่มีด้ายหลุด (No Loose Threads)                                     │    │
│   │  ☐ ซิป/กระดุมใช้งานได้ (Functional Hardware)                             │    │
│   │  ☐ ป้ายติดถูกตำแหน่ง (Label Position)                                   │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   QC Result Actions:                                                             │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │   PASS ──→ Continue to Next Stage                                     │    │
│   │                                                                        │    │
│   │   FAIL (Minor) ──→ Rework ──→ Re-QC                                   │    │
│   │   ├─ สีจาง: พิมพ์ซ้ำ                                                    │    │
│   │   ├─ ด้ายหลุด: ตัดด้าย                                                  │    │
│   │   └─ รอยเปื้อน: ซักทำความสะอาด                                          │    │
│   │                                                                        │    │
│   │   FAIL (Major) ──→ Reject ──→ Produce New                             │    │
│   │   ├─ ลายผิด: ทำใหม่                                                    │    │
│   │   ├─ ไซส์ผิด: ตัดใหม่                                                   │    │
│   │   └─ เสียหายไม่สามารถแก้ได้                                             │    │
│   │                                                                        │    │
│   │   ⚠️ Track จำนวน Fail/Rework ต่อ Order และ ต่อ Worker                  │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 💰 Quotation System

### ระบบใบเสนอราคา

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         QUOTATION SYSTEM                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 วัตถุประสงค์:                                                               │
│   - สร้างใบเสนอราคาให้ลูกค้าก่อนสั่งซื้อ                                          │
│   - ลูกค้าสามารถ Approve/Reject/Request Change                                  │
│   - Convert เป็น Order เมื่อลูกค้าตกลง                                           │
│   - Track ประวัติใบเสนอราคา                                                      │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  QUOTATION FLOW                                                        │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │   ลูกค้าติดต่อมา                                                        │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [Create Quotation] ──→ กรอกรายละเอียด ──→ คำนวณราคา                  │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [DRAFT] ──→ Review ──→ [SENT TO CUSTOMER]                           │    │
│   │                               │                                        │    │
│   │              ┌────────────────┼────────────────┐                       │    │
│   │              ▼                ▼                ▼                       │    │
│   │         [APPROVED]      [REVISION]       [REJECTED]                   │    │
│   │              │                │                │                       │    │
│   │              │                │                └──→ Lost Lead         │    │
│   │              │                │                                        │    │
│   │              │                └──→ แก้ไข ──→ Send Again               │    │
│   │              │                                                         │    │
│   │              ▼                                                         │    │
│   │   [CONVERT TO ORDER] ──→ สร้าง Order อัตโนมัติ                         │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ⏱️ Quotation Validity: 7-30 วัน (ตั้งค่าได้)                                   │
│   📧 Auto-remind ก่อนหมดอายุ                                                    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Quotation Document

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                      📄 QUOTATION                                      │    │
│   │                                                                        │    │
│   │  Quotation No: QT-2024-0001              Date: 2024-12-05             │    │
│   │  Valid Until:  2024-12-19 (14 days)      Version: 1                   │    │
│   │                                                                        │    │
│   │  ──────────────────────────────────────────────────────────────────   │    │
│   │  Customer:  บริษัท ABC จำกัด                                          │    │
│   │  Contact:   คุณสมชาย 081-xxx-xxxx                                     │    │
│   │  Email:     somchai@abc.com                                           │    │
│   │  ──────────────────────────────────────────────────────────────────   │    │
│   │                                                                        │    │
│   │  # │ Description                        │ Qty │ Unit    │ Total       │    │
│   │  ──┼────────────────────────────────────┼─────┼─────────┼─────────────│    │
│   │  1 │ เสื้อโปโล Cotton สีขาว              │ 100 │ ฿150    │ ฿15,000     │    │
│   │    │ • สกรีน DTF หน้าอก A4              │ 100 │ ฿35     │ ฿3,500      │    │
│   │    │ • ปักโลโก้อก 5x5cm                 │ 100 │ ฿30     │ ฿3,000      │    │
│   │    │ • ป้ายทอ (outsource)               │ 100 │ ฿5      │ ฿500        │    │
│   │  ──┼────────────────────────────────────┼─────┼─────────┼─────────────│    │
│   │  2 │ Hang Tag พิมพ์โลโก้                │ 100 │ ฿3      │ ฿300        │    │
│   │  3 │ ถุง OPP                            │ 100 │ ฿2      │ ฿200        │    │
│   │  ──┴────────────────────────────────────┴─────┴─────────┴─────────────│    │
│   │                                              Subtotal:    ฿22,500     │    │
│   │                                              Discount:    -฿500       │    │
│   │                                              Shipping:    ฿150        │    │
│   │                                              ─────────────────────    │    │
│   │                                              TOTAL:       ฿22,150     │    │
│   │                                                                        │    │
│   │  ──────────────────────────────────────────────────────────────────   │    │
│   │  📅 Lead Time:      14 working days                                   │    │
│   │  💳 Payment Terms:  50% deposit, 50% before delivery                  │    │
│   │  📦 Delivery:       Kerry Express                                     │    │
│   │  ──────────────────────────────────────────────────────────────────   │    │
│   │                                                                        │    │
│   │  Notes:                                                               │    │
│   │  - ราคานี้ยังไม่รวม VAT 7%                                             │    │
│   │  - ราคาป้ายทอเป็นราคาประมาณ อาจปรับตามจริง                              │    │
│   │  - ต้องส่งไฟล์ออกแบบภายใน 3 วันหลังยืนยัน                               │    │
│   │                                                                        │    │
│   │  ──────────────────────────────────────────────────────────────────   │    │
│   │                                                                        │    │
│   │  [📥 Download PDF]  [📧 Send to Customer]  [✏️ Edit]  [📋 Duplicate] │    │
│   │                                                                        │    │
│   │  Customer Response:  [✅ Approve]  [🔄 Request Change]  [❌ Reject]   │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🧾 Invoice & Payment

### ระบบใบแจ้งหนี้และการชำระเงิน

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         INVOICE & PAYMENT SYSTEM                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  DOCUMENT TYPES                                                        │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  📄 QUOTATION (ใบเสนอราคา)                                             │    │
│   │     └─→ เสนอราคาให้ลูกค้า                                               │    │
│   │                                                                        │    │
│   │  📄 INVOICE (ใบแจ้งหนี้)                                                │    │
│   │     ├─→ INV สำหรับมัดจำ (Deposit Invoice)                              │    │
│   │     ├─→ INV สำหรับงวดที่เหลือ (Balance Invoice)                        │    │
│   │     └─→ INV ยอดเต็ม (Full Invoice)                                     │    │
│   │                                                                        │    │
│   │  📄 RECEIPT (ใบเสร็จรับเงิน)                                            │    │
│   │     └─→ ออกเมื่อรับชำระเงินแล้ว                                          │    │
│   │                                                                        │    │
│   │  📄 TAX INVOICE (ใบกำกับภาษี) - Optional                               │    │
│   │     └─→ สำหรับลูกค้าที่ต้องการ VAT                                       │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  PAYMENT FLOW                                                          │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │   Order Confirmed                                                      │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   ┌─────────────────────────────────────────────────────────────────┐ │    │
│   │   │  Payment Terms: [● 50/50] [○ 30/70] [○ Full] [○ Credit 30d]    │ │    │
│   │   └─────────────────────────────────────────────────────────────────┘ │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   ┌─────────────────────────────────────────────────────────────────┐ │    │
│   │   │  50/50 PAYMENT FLOW:                                            │ │    │
│   │   │                                                                 │ │    │
│   │   │  INV-001 (มัดจำ 50%)  ──→ ลูกค้าชำระ ──→ REC-001 ──→ เริ่มผลิต  │ │    │
│   │   │        │                                                        │ │    │
│   │   │        ▼                                                        │ │    │
│   │   │  [ผลิตเสร็จ / ก่อนส่ง]                                           │ │    │
│   │   │        │                                                        │ │    │
│   │   │        ▼                                                        │ │    │
│   │   │  INV-002 (ยอดคงเหลือ) ──→ ลูกค้าชำระ ──→ REC-002 ──→ จัดส่ง     │ │    │
│   │   │                                                                 │ │    │
│   │   └─────────────────────────────────────────────────────────────────┘ │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Payment Tracking

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  💳 Order #ORD-2024-0123 - Payment Status                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Customer: บริษัท ABC จำกัด                   Total: ฿22,150                    │
│  Payment Terms: 50% Deposit                                                     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Payment Progress                                                      │     │
│  │  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░░ 50% (฿11,075 / ฿22,150)                │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  # │ Document   │ Amount   │ Due Date   │ Status     │ Paid Date      │     │
│  ├────┼────────────┼──────────┼────────────┼────────────┼────────────────┤     │
│  │ 1  │ INV-0001   │ ฿11,075  │ 2024-12-07 │ ✅ Paid    │ 2024-12-06     │     │
│  │ 2  │ INV-0002   │ ฿11,075  │ 2024-12-20 │ ⏳ Pending │ -              │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  💰 Payment Records                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Date       │ Amount   │ Method       │ Reference      │ Verified     │     │
│  ├─────────────┼──────────┼──────────────┼────────────────┼──────────────┤     │
│  │ 2024-12-06  │ ฿11,075  │ Bank Transfer│ SCB 12:45      │ ✅ Admin A   │     │
│  │             │          │              │ 📎 slip.jpg    │              │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  [📥 Download Invoice]  [📧 Send Reminder]  [➕ Record Payment]                  │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Payment Methods

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  💳 Supported Payment Methods                                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  🏦 Bank Transfer (โอนเงิน)                                                      │
│  ├─ ธ.กสิกรไทย xxx-x-xxxxx-x (บริษัท อนาจัก จำกัด)                              │
│  ├─ ธ.ไทยพาณิชย์ xxx-x-xxxxx-x (บริษัท อนาจัก จำกัด)                            │
│  └─ ลูกค้าแนบสลิป → Admin verify → บันทึกการชำระ                                 │
│                                                                                  │
│  📱 PromptPay                                                                    │
│  └─ หมายเลข: xxx-xxx-xxxx หรือ QR Code                                          │
│                                                                                  │
│  💵 Cash (เงินสด)                                                                │
│  └─ รับที่โรงงาน หรือ COD                                                        │
│                                                                                  │
│  💳 Credit Card (บัตรเครดิต) - Future                                           │
│  └─ ผ่าน Payment Gateway                                                        │
│                                                                                  │
│  📅 Credit Terms (เครดิต)                                                        │
│  ├─ เฉพาะลูกค้า Tier: Corporate/VIP                                             │
│  └─ 15/30/45/60 วัน                                                             │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🧮 Pricing Engine

### ระบบคำนวณราคาอัตโนมัติ

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         PRICING ENGINE                                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 Price Calculation:                                                          │
│                                                                                  │
│   Final Price = (Base + Work + Addons) × Quantity × Tier Modifier               │
│                 - Quantity Discount - Promotion + Rush Fee + Shipping           │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  PRICING COMPONENTS                                                    │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  1️⃣ BASE PRICE (ราคาสินค้าพื้นฐาน)                                     │    │
│   │     ├─ จาก Product master data                                        │    │
│   │     └─ หรือ ลูกค้าส่งเสื้อมาเอง = ฿0                                    │    │
│   │                                                                        │    │
│   │  2️⃣ WORK PRICE (ค่างาน)                                                │    │
│   │     ├─ ตาม Work Type                                                  │    │
│   │     ├─ ตาม Position + Size                                            │    │
│   │     └─ ตาม Quantity tiers                                             │    │
│   │                                                                        │    │
│   │  3️⃣ ADDON PRICE (ค่า Addon)                                           │    │
│   │     └─ per piece / per lot / fixed                                    │    │
│   │                                                                        │    │
│   │  4️⃣ CUSTOMER TIER (ส่วนลดตาม Tier)                                    │    │
│   │     ├─ Retail:     0%                                                 │    │
│   │     ├─ Wholesale:  5-10%                                              │    │
│   │     ├─ Corporate:  10-15%                                             │    │
│   │     └─ VIP:        15-20%                                             │    │
│   │                                                                        │    │
│   │  5️⃣ QUANTITY DISCOUNT (ส่วนลดตามจำนวน)                                 │    │
│   │     ├─ 50-99:      5%                                                 │    │
│   │     ├─ 100-299:    10%                                                │    │
│   │     ├─ 300-499:    15%                                                │    │
│   │     └─ 500+:       20%                                                │    │
│   │                                                                        │    │
│   │  6️⃣ RUSH FEE (ค่าเร่งด่วน)                                             │    │
│   │     ├─ Rush:       +20%                                               │    │
│   │     ├─ Urgent:     +50%                                               │    │
│   │     └─ Emergency:  +100%                                              │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Work Type Pricing

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  🖨️ Work Type Pricing Configuration                                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Work Type: DTF Printing                                                        │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Position      │ Size   │ 1-49    │ 50-99   │ 100-299 │ 300+          │     │
│  ├────────────────┼────────┼─────────┼─────────┼─────────┼───────────────┤     │
│  │ Front Chest    │ A6     │ ฿25     │ ฿22     │ ฿20     │ ฿18           │     │
│  │ Front Chest    │ A5     │ ฿30     │ ฿27     │ ฿25     │ ฿22           │     │
│  │ Front Chest    │ A4     │ ฿35     │ ฿32     │ ฿30     │ ฿27           │     │
│  │ Front Full     │ A3     │ ฿50     │ ฿45     │ ฿40     │ ฿35           │     │
│  │ Back Full      │ A3     │ ฿50     │ ฿45     │ ฿40     │ ฿35           │     │
│  │ Sleeve         │ A6     │ ฿20     │ ฿18     │ ฿15     │ ฿12           │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ⚠️ ราคานี้สำหรับ In-house เท่านั้น                                              │
│  📤 Outsource price = Supplier price + margin (20-30%)                          │
│                                                                                  │
│  [➕ Add Position]  [📥 Import Prices]  [💾 Save]                                │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 📦 Shipping & Delivery

### ระบบจัดส่ง

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         SHIPPING & DELIVERY SYSTEM                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  DELIVERY METHODS                                                      │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  🚚 Kerry Express                                                      │    │
│   │     ├─ Standard: 1-3 วัน (฿50-150)                                    │    │
│   │     └─ Express:  1 วัน (฿100-200)                                     │    │
│   │                                                                        │    │
│   │  ⚡ Flash Express                                                      │    │
│   │     ├─ Standard: 1-2 วัน (฿40-120)                                    │    │
│   │     └─ Express:  Same day (฿80-180)                                   │    │
│   │                                                                        │    │
│   │  📦 J&T Express                                                        │    │
│   │     └─ Standard: 2-3 วัน (฿40-100)                                    │    │
│   │                                                                        │    │
│   │  🏢 Pickup (รับเอง)                                                    │    │
│   │     └─ ที่โรงงาน: ฿0                                                   │    │
│   │                                                                        │    │
│   │  🚗 Own Delivery (ส่งเอง)                                              │    │
│   │     └─ กรุงเทพฯ และปริมณฑล: ฿100-300                                  │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  SHIPPING FLOW                                                         │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │   Production Complete + QC Passed + Final Payment                      │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [READY TO SHIP]                                                     │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   ┌─────────────────────────────────────────────────────────────────┐ │    │
│   │   │  Create Shipment:                                               │ │    │
│   │   │  • Select carrier                                               │ │    │
│   │   │  • Print label / booking                                        │ │    │
│   │   │  • Pack & weigh                                                 │ │    │
│   │   └─────────────────────────────────────────────────────────────────┘ │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [SHIPPED] ──→ Tracking number assigned                              │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [IN TRANSIT] ──→ Track via carrier API                              │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [DELIVERED] ──→ Auto-complete order                                 │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Split Shipment (แยกส่งหลายรอบ)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📦 Order #ORD-2024-0123 - Split Shipment                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ⚠️ กรณีต้องแยกส่ง:                                                              │
│  • บางรายการเสร็จก่อน                                                           │
│  • ของไม่พอส่งครบในครั้งเดียว                                                    │
│  • ลูกค้าต้องการส่งหลายที่อยู่                                                   │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Shipment 1 - Shipped ✅                                               │     │
│  │  Tracking: KERTH12345678 (Kerry Express)                               │     │
│  │  ├─ เสื้อโปโล ขาว M x 30                                                │     │
│  │  └─ เสื้อโปโล ขาว L x 20                                                │     │
│  │  Shipped: 2024-12-15 | Delivered: 2024-12-17                           │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Shipment 2 - Ready to Ship 📦                                         │     │
│  │  ├─ เสื้อโปโล ขาว S x 20                                                │     │
│  │  ├─ เสื้อโปโล ขาว XL x 10                                               │     │
│  │  └─ Hang Tag x 100                                                     │     │
│  │  [Create Shipment]                                                     │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Shipment 3 - Waiting ⏳ (รอป้ายทอจาก Supplier)                         │     │
│  │  └─ ป้ายทอ x 100 (ETA: 2024-12-20)                                     │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 👤 Customer Portal

### หน้าลูกค้า (ไม่ต้อง Login)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         CUSTOMER PORTAL                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🔗 Access: https://order.anajak.com/[ORDER_TOKEN]                             │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                        │    │
│   │  ┌────────────────────────────────────────────────────────────────┐   │    │
│   │  │  🏭 ANAJAK TSHIRT                                              │   │    │
│   │  │                                                                │   │    │
│   │  │  Order #ORD-2024-0123                                          │   │    │
│   │  │  Status: 🟡 รอยืนยัน Mockup                                     │   │    │
│   │  │                                                                │   │    │
│   │  │  ──────────────────────────────────────────────────────────── │   │    │
│   │  │                                                                │   │    │
│   │  │  📋 รายการสั่งซื้อ                                              │   │    │
│   │  │  ├─ เสื้อโปโล Cotton ขาว x 100 ตัว                             │   │    │
│   │  │  │   • สกรีน DTF หน้าอก                                        │   │    │
│   │  │  │   • ปักโลโก้อก                                              │   │    │
│   │  │  ├─ Hang Tag x 100                                            │   │    │
│   │  │  └─ ถุง OPP x 100                                             │   │    │
│   │  │                                                                │   │    │
│   │  │  💰 ยอดรวม: ฿22,150                                            │   │    │
│   │  │  ✅ ชำระแล้ว: ฿11,075 (50%)                                    │   │    │
│   │  │  ⏳ คงเหลือ: ฿11,075                                           │   │    │
│   │  │                                                                │   │    │
│   │  │  ──────────────────────────────────────────────────────────── │   │    │
│   │  │                                                                │   │    │
│   │  │  🖼️ Mockup รอยืนยัน                                            │   │    │
│   │  │  ┌─────────┐ ┌─────────┐                                      │   │    │
│   │  │  │ [Front] │ │ [Back]  │                                      │   │    │
│   │  │  │         │ │         │                                      │   │    │
│   │  │  └─────────┘ └─────────┘                                      │   │    │
│   │  │                                                                │   │    │
│   │  │  [✅ ยืนยัน Mockup]  [🔄 ขอแก้ไข]                              │   │    │
│   │  │                                                                │   │    │
│   │  │  ⚠️ หลังยืนยันแล้ว การแก้ไขจะมีค่าใช้จ่ายเพิ่มเติม               │   │    │
│   │  │                                                                │   │    │
│   │  │  ──────────────────────────────────────────────────────────── │   │    │
│   │  │                                                                │   │    │
│   │  │  📅 Timeline                                                   │   │    │
│   │  │  ✅ 05/12 สร้าง Order                                          │   │    │
│   │  │  ✅ 06/12 ชำระมัดจำ                                             │   │    │
│   │  │  ✅ 07/12 Design เสร็จ                                         │   │    │
│   │  │  🟡 08/12 รอยืนยัน Mockup ← คุณอยู่ที่นี่                        │   │    │
│   │  │  ⏳ 10/12 เริ่มผลิต                                             │   │    │
│   │  │  ⏳ 18/12 QC                                                   │   │    │
│   │  │  ⏳ 19/12 ชำระยอดคงเหลือ                                        │   │    │
│   │  │  ⏳ 20/12 จัดส่ง                                                │   │    │
│   │  │                                                                │   │    │
│   │  │  ──────────────────────────────────────────────────────────── │   │    │
│   │  │                                                                │   │    │
│   │  │  💳 ชำระเงิน                                                   │   │    │
│   │  │  [แจ้งชำระเงิน] [ดูรายละเอียดบัญชี]                             │   │    │
│   │  │                                                                │   │    │
│   │  │  📞 ติดต่อเรา                                                   │   │    │
│   │  │  LINE: @anajaktshirt | Tel: 02-xxx-xxxx                       │   │    │
│   │  │                                                                │   │    │
│   │  └────────────────────────────────────────────────────────────────┘   │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Customer Actions

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  👤 What Customers Can Do                                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ✅ VIEW                                                                         │
│  ├─ รายละเอียด Order                                                            │
│  ├─ สถานะปัจจุบัน + Timeline                                                    │
│  ├─ Mockup / Design                                                             │
│  ├─ ยอดชำระ + ประวัติการชำระ                                                     │
│  └─ Tracking number                                                             │
│                                                                                  │
│  ✅ ACTIONS                                                                      │
│  ├─ ยืนยัน/ปฏิเสธ Mockup                                                        │
│  ├─ แจ้งชำระเงิน + แนบสลิป                                                      │
│  ├─ ส่งข้อความ/หมายเหตุ                                                         │
│  ├─ Request Change (สร้าง Change Request)                                       │
│  └─ Download Invoice/Receipt                                                    │
│                                                                                  │
│  ❌ CANNOT DO                                                                    │
│  ├─ แก้ไข Order โดยตรง                                                          │
│  ├─ ดู Order อื่น                                                               │
│  └─ ดูข้อมูลภายใน                                                               │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 Repeat Order System

### ระบบสั่งซ้ำ

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         REPEAT ORDER SYSTEM                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   🎯 สำหรับ:                                                                     │
│   - ลูกค้าสั่งซ้ำ Order เดิม                                                     │
│   - สั่งเพิ่มเติมจาก Order ที่เคยทำ                                              │
│   - ไม่ต้องออกแบบใหม่ (ใช้ Design เดิม)                                          │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  REPEAT ORDER FLOW                                                     │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │   Previous Order (Completed)                                           │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   [🔄 Repeat Order]                                                   │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   ┌─────────────────────────────────────────────────────────────────┐ │    │
│   │   │  Create from: #ORD-2024-0100                                    │ │    │
│   │   │                                                                 │ │    │
│   │   │  ☑ Copy items & quantities                                     │ │    │
│   │   │  ☑ Copy design files (ใช้ไฟล์เดิม)                              │ │    │
│   │   │  ☑ Copy addons                                                 │ │    │
│   │   │  ☐ Copy shipping address                                       │ │    │
│   │   │                                                                 │ │    │
│   │   │  What's different:                                              │ │    │
│   │   │  • New order number                                             │ │    │
│   │   │  • New due date (recalculate)                                   │ │    │
│   │   │  • Price recalculate (ราคาอาจเปลี่ยน)                            │ │    │
│   │   │                                                                 │ │    │
│   │   │  [Create Repeat Order]                                          │ │    │
│   │   └─────────────────────────────────────────────────────────────────┘ │    │
│   │        │                                                               │    │
│   │        ▼                                                               │    │
│   │   New Order Created                                                   │    │
│   │   (Skip design phase → Auto-approved → Ready for payment)             │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   💡 Benefits:                                                                   │
│   • เร็วกว่าสั่งใหม่ (ข้าม Design + Mockup)                                     │
│   • ไม่ต้องส่งไฟล์ใหม่                                                          │
│   • ลดโอกาสผิดพลาด                                                             │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Previous Orders List

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  🔄 Repeat Order - Select Previous Order                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  Customer: บริษัท ABC จำกัด                                                      │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Order       │ Date       │ Items                │ Total    │ Action   │     │
│  ├─────────────┼────────────┼──────────────────────┼──────────┼──────────┤     │
│  │ ORD-0100    │ 2024-11-15 │ เสื้อโปโล ขาว x 100   │ ฿22,150  │ [Repeat] │     │
│  │             │            │ DTF + ปัก + ป้าย      │          │          │     │
│  ├─────────────┼────────────┼──────────────────────┼──────────┼──────────┤     │
│  │ ORD-0085    │ 2024-10-20 │ เสื้อยืด ดำ x 50      │ ฿8,500   │ [Repeat] │     │
│  │             │            │ DTF หน้า+หลัง         │          │          │     │
│  ├─────────────┼────────────┼──────────────────────┼──────────┼──────────┤     │
│  │ ORD-0072    │ 2024-09-10 │ เสื้อทีม x 30         │ ฿5,400   │ [Repeat] │     │
│  │             │            │ DTF + ชื่อ-เบอร์       │          │          │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  [View Order Details]                                                            │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔔 Notification System

### ระบบแจ้งเตือน

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         NOTIFICATION SYSTEM                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  NOTIFICATION CHANNELS                                                 │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  📱 LINE Notify                                                        │    │
│   │     ├─ ส่งถึงลูกค้า (via LINE Official)                               │    │
│   │     └─ ส่งถึงทีมงาน (via Group)                                       │    │
│   │                                                                        │    │
│   │  📧 Email                                                              │    │
│   │     ├─ Quotation / Invoice                                            │    │
│   │     └─ Order updates                                                  │    │
│   │                                                                        │    │
│   │  🔔 In-App                                                             │    │
│   │     └─ แจ้งเตือนในระบบ                                                 │    │
│   │                                                                        │    │
│   │  📲 SMS (Optional)                                                     │    │
│   │     └─ เฉพาะกรณีสำคัญ                                                  │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  NOTIFICATION EVENTS                                                   │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  👤 TO CUSTOMER                                                        │    │
│   │  ├─ ใบเสนอราคาพร้อม                                                    │    │
│   │  ├─ รอชำระเงิน (มัดจำ/ยอดคงเหลือ)                                      │    │
│   │  ├─ ยืนยันการชำระเงินแล้ว                                               │    │
│   │  ├─ Mockup พร้อมให้ยืนยัน                                              │    │
│   │  ├─ เริ่มผลิตแล้ว                                                       │    │
│   │  ├─ ผลิตเสร็จ รอชำระยอดคงเหลือ                                         │    │
│   │  ├─ จัดส่งแล้ว + Tracking                                              │    │
│   │  ├─ Change Request อัปเดต                                             │    │
│   │  └─ Reminder: Mockup ยังไม่ยืนยัน / ยังไม่ชำระ                         │    │
│   │                                                                        │    │
│   │  👷 TO INTERNAL TEAM                                                   │    │
│   │  ├─ Order ใหม่เข้ามา                                                   │    │
│   │  ├─ ลูกค้าชำระเงินแล้ว                                                  │    │
│   │  ├─ ลูกค้ายืนยัน/ปฏิเสธ Mockup                                         │    │
│   │  ├─ Change Request ใหม่                                               │    │
│   │  ├─ Issue/Problem reported                                            │    │
│   │  ├─ PO เลยกำหนด                                                        │    │
│   │  ├─ Order ใกล้ Due date                                               │    │
│   │  └─ Low stock warning                                                 │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### LINE Notify Templates

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📱 LINE Notify Templates                                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━                        │
│  📋 Mockup Ready                                                                │
│  ────────────────────────────────────────────────────────                       │
│  🏭 Anajak T-Shirt                                                              │
│                                                                                  │
│  สวัสดีค่ะ คุณ[ชื่อลูกค้า]                                                        │
│                                                                                  │
│  Mockup ของคุณพร้อมให้ตรวจสอบแล้วค่ะ                                             │
│  Order: #ORD-2024-0123                                                          │
│                                                                                  │
│  📎 ดู Mockup และยืนยัน:                                                         │
│  https://order.anajak.com/xxx                                                   │
│                                                                                  │
│  ⚠️ กรุณายืนยันภายใน 3 วัน                                                       │
│  หากไม่มีการตอบกลับ จะถือว่ายืนยันอัตโนมัติ                                       │
│                                                                                  │
│  ขอบคุณค่ะ 🙏                                                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━                        │
│                                                                                  │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━                        │
│  📦 Order Shipped                                                               │
│  ────────────────────────────────────────────────────────                       │
│  🏭 Anajak T-Shirt                                                              │
│                                                                                  │
│  สินค้าของคุณจัดส่งแล้วค่ะ 🚚                                                     │
│  Order: #ORD-2024-0123                                                          │
│                                                                                  │
│  📦 Kerry Express                                                               │
│  Tracking: KERTH12345678                                                        │
│                                                                                  │
│  🔍 ติดตามพัสดุ:                                                                 │
│  https://th.kerryexpress.com/track                                              │
│                                                                                  │
│  ขอบคุณที่ใช้บริการค่ะ 🙏                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━                        │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 📊 Reports & Analytics

### รายงานและสถิติ

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         REPORTS & ANALYTICS                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌────────────────────────────────────────────────────────────────────────┐    │
│   │  📊 REPORT TYPES                                                       │    │
│   ├────────────────────────────────────────────────────────────────────────┤    │
│   │                                                                        │    │
│   │  💰 SALES REPORTS                                                      │    │
│   │  ├─ Daily/Weekly/Monthly sales                                        │    │
│   │  ├─ Sales by customer                                                 │    │
│   │  ├─ Sales by product/work type                                        │    │
│   │  ├─ Average order value                                               │    │
│   │  └─ Quotation conversion rate                                         │    │
│   │                                                                        │    │
│   │  🏭 PRODUCTION REPORTS                                                 │    │
│   │  ├─ Orders in production                                              │    │
│   │  ├─ Production efficiency                                             │    │
│   │  ├─ Lead time analysis                                                │    │
│   │  ├─ QC pass/fail rate                                                 │    │
│   │  └─ Rework rate                                                       │    │
│   │                                                                        │    │
│   │  📤 OUTSOURCE REPORTS                                                  │    │
│   │  ├─ PO summary                                                        │    │
│   │  ├─ Supplier performance                                              │    │
│   │  ├─ Cost analysis                                                     │    │
│   │  └─ Delivery on-time rate                                             │    │
│   │                                                                        │    │
│   │  👤 CUSTOMER REPORTS                                                   │    │
│   │  ├─ Top customers                                                     │    │
│   │  ├─ Customer retention                                                │    │
│   │  ├─ New vs returning                                                  │    │
│   │  └─ Average customer lifetime value                                   │    │
│   │                                                                        │    │
│   │  🚨 ISSUE REPORTS                                                      │    │
│   │  ├─ Issues by type/source                                             │    │
│   │  ├─ Resolution time                                                   │    │
│   │  └─ Cost of issues                                                    │    │
│   │                                                                        │    │
│   └────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### Dashboard Overview

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📊 Dashboard - December 2024                                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐│
│  │  💰 Sales MTD   │ │  📦 Orders      │ │  🏭 Production  │ │  ⚠️ Issues     ││
│  │  ฿ 245,000     │ │  32 orders      │ │  28 active      │ │  3 open        ││
│  │  ▲ +15%        │ │  ▲ +8%          │ │  85% on-time    │ │  ▼ -2          ││
│  └─────────────────┘ └─────────────────┘ └─────────────────┘ └─────────────────┘│
│                                                                                  │
│  📈 Sales Trend (Last 30 days)                                                   │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │ ฿15k │                                              ▄▄                │     │
│  │      │                              ▄▄    ▄▄  ▄▄▄▄██                  │     │
│  │ ฿10k │              ▄▄        ▄▄▄▄████▄▄██████████                    │     │
│  │      │    ▄▄  ▄▄▄▄████████████████████████████████                    │     │
│  │ ฿5k  │ ▄▄████████████████████████████████████████████                 │     │
│  │      └─────────────────────────────────────────────────────────────── │     │
│  │        05    10    15    20    25    30                               │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  🔥 Top Products This Month           👤 Top Customers                          │
│  ┌────────────────────────────┐       ┌────────────────────────────────┐        │
│  │ 1. DTF Printing    ฿85,000 │       │ 1. บริษัท ABC    ฿45,000       │        │
│  │ 2. Embroidery      ฿42,000 │       │ 2. บริษัท XYZ    ฿32,000       │        │
│  │ 3. Labels          ฿28,000 │       │ 3. ร้าน DEF      ฿28,000       │        │
│  └────────────────────────────┘       └────────────────────────────────┘        │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 📅 Production Calendar

### ปฏิทินการผลิต

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         PRODUCTION CALENDAR                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  📅 December 2024                              [< Prev]  [Today]  [Next >]      │
│                                                                                  │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Mon      Tue      Wed      Thu      Fri      Sat      Sun             │     │
│  ├──────────────────────────────────────────────────────────────────────┤     │
│  │                                                       1                │     │
│  │  2        3        4        5        6        7        8              │     │
│  │  ▓▓▓▓▓   ▓▓▓▓▓   ▓▓▓▓▓   ▓▓▓▓▓   ▓▓▓▓▓   ░░░░░                       │     │
│  │  Load:    Load:    Load:    Load:    Load:                            │     │
│  │  180/200  195/200  200/200  150/200  180/200                          │     │
│  │                                                                       │     │
│  │  9        10       11       12       13       14       15             │     │
│  │  ▓▓▓▓▓   ▓▓▓▓▓   ▓▓▓▓▓   ▓▓▓▓░   ▓▓▓░░   ░░░░░                       │     │
│  │  200/200  200/200  200/200  160/200  120/200                          │     │
│  │  ⚠️FULL   ⚠️FULL   ⚠️FULL                                              │     │
│  │                                                                       │     │
│  │  16       17       18       19       20       21       22             │     │
│  │  ▓▓░░░   ▓▓░░░   ▓▓░░░   ▓░░░░   ▓░░░░   ░░░░░                       │     │
│  │  80/200   70/200   60/200   40/200   30/200                           │     │
│  │                                                                       │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  📋 Orders Due This Week:                                                        │
│  ┌────────────────────────────────────────────────────────────────────────┐     │
│  │  Dec 9  │ ORD-0123 │ ABC Corp    │ 100 pcs │ DTF      │ 🟢 On Track   │     │
│  │  Dec 10 │ ORD-0124 │ XYZ Ltd     │ 50 pcs  │ DTF+Emb  │ 🟡 At Risk    │     │
│  │  Dec 11 │ ORD-0125 │ DEF Shop    │ 200 pcs │ DTF      │ 🟢 On Track   │     │
│  │  Dec 12 │ ORD-0126 │ GHI Inc     │ 80 pcs  │ DTF+Emb  │ 🔴 Delayed    │     │
│  └────────────────────────────────────────────────────────────────────────┘     │
│                                                                                  │
│  Legend: ▓ Booked  ░ Available  ⚠️ Full capacity                                │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🗄️ Database Schema Updates

### New/Updated Tables

```sql
-- =============================================
-- 1. ORDER TYPES (รูปแบบการผลิต)
-- =============================================
CREATE TABLE IF NOT EXISTS order_types (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code TEXT UNIQUE NOT NULL, -- 'ready_made', 'custom_sewing', 'full_custom', 'print_only'
  name TEXT NOT NULL,
  name_th TEXT NOT NULL,
  description TEXT,
  default_lead_days INTEGER DEFAULT 7,
  requires_pattern BOOLEAN DEFAULT false,
  requires_fabric BOOLEAN DEFAULT false,
  sort_order INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

INSERT INTO order_types (code, name, name_th, default_lead_days, requires_pattern, requires_fabric) VALUES
('ready_made', 'Ready-Made', 'เสื้อสำเร็จรูป', 5, false, false),
('custom_sewing', 'Custom Sewing', 'ตัดเย็บตามแบบ', 14, true, true),
('full_custom', 'Full Custom', 'ออกแบบ+ตัดเย็บ', 21, true, true),
('print_only', 'Print Only', 'สกรีน/ปักอย่างเดียว', 3, false, false);

-- =============================================
-- 2. WORK DEPENDENCIES (ลำดับงาน)
-- =============================================
CREATE TABLE IF NOT EXISTS work_dependencies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  work_type_code TEXT NOT NULL, -- งานที่ต้องทำหลัง
  depends_on_code TEXT NOT NULL, -- งานที่ต้องทำก่อน
  order_type_code TEXT, -- NULL = ใช้กับทุก order type
  is_required BOOLEAN DEFAULT true, -- ต้องรอให้เสร็จก่อน หรือแค่แนะนำ
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(work_type_code, depends_on_code, order_type_code)
);

INSERT INTO work_dependencies (work_type_code, depends_on_code, order_type_code, is_required) VALUES
-- Custom sewing dependencies
('sewing', 'cutting', 'custom_sewing', true),
('dtg', 'sewing', 'custom_sewing', true),
('dtf', 'sewing', 'custom_sewing', true),
('embroidery', 'sewing', 'custom_sewing', true),
-- Sublimation ต้องทำก่อนเย็บ
('sewing', 'sublimation', 'custom_sewing', false), -- optional
-- Label ต้องหลังเย็บ
('woven_label', 'sewing', NULL, true),
('printed_label', 'sewing', NULL, true),
-- Finishing ต้องหลังทุก print/emb
('finishing', 'dtg', NULL, false),
('finishing', 'dtf', NULL, false),
('finishing', 'embroidery', NULL, false),
('finishing', 'silkscreen', NULL, false),
-- Packaging ต้องหลัง finishing
('packaging', 'finishing', NULL, false);

-- =============================================
-- 3. ADDONS
-- =============================================
CREATE TABLE IF NOT EXISTS addon_types (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  name_th TEXT NOT NULL,
  category TEXT NOT NULL, -- 'packaging', 'labeling', 'finishing', 'extra'
  base_price DECIMAL(10,2) DEFAULT 0,
  price_type TEXT DEFAULT 'per_piece', -- 'per_piece', 'per_lot', 'fixed'
  requires_design BOOLEAN DEFAULT false,
  requires_material BOOLEAN DEFAULT false,
  sort_order INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

INSERT INTO addon_types (code, name, name_th, category, base_price, price_type, requires_design) VALUES
-- Packaging
('opp_bag', 'OPP Bag', 'ถุง OPP', 'packaging', 2, 'per_piece', false),
('zipper_bag', 'Zipper Bag', 'ถุงซิป', 'packaging', 5, 'per_piece', false),
('paper_bag', 'Paper Bag', 'ถุงกระดาษ', 'packaging', 15, 'per_piece', true),
('box', 'Box', 'กล่อง', 'packaging', 25, 'per_piece', true),
('gift_box', 'Gift Box', 'กล่องของขวัญ', 'packaging', 50, 'per_piece', true),
-- Labeling
('hang_tag', 'Hang Tag', 'แท็กห้อย', 'labeling', 3, 'per_piece', true),
('care_label', 'Care Label', 'ป้ายซัก', 'labeling', 2, 'per_piece', false),
('size_label', 'Size Label', 'ป้ายไซส์', 'labeling', 1, 'per_piece', false),
('brand_label', 'Brand Label', 'ป้ายแบรนด์', 'labeling', 3, 'per_piece', true),
-- Finishing
('fold_pack', 'Fold & Pack', 'พับแพค', 'finishing', 5, 'per_piece', false),
('press', 'Press', 'รีด', 'finishing', 3, 'per_piece', false),
('steam', 'Steam', 'นึ่ง', 'finishing', 5, 'per_piece', false),
('spray_treatment', 'Spray Treatment', 'สเปรย์กันน้ำ/กันยับ', 'finishing', 10, 'per_piece', false),
-- Extra
('individual_pack', 'Individual Pack', 'แยกใส่ถุงพร้อมชื่อ', 'extra', 2, 'per_piece', false),
('size_sorting', 'Size Sorting', 'แยกไซส์', 'extra', 50, 'per_lot', false),
('photo', 'Product Photo', 'ถ่ายรูปสินค้า', 'extra', 200, 'fixed', false);

-- Order Addons (addon ที่เลือกในแต่ละ order)
CREATE TABLE IF NOT EXISTS order_addons (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  order_id UUID REFERENCES orders(id) ON DELETE CASCADE,
  order_item_id UUID, -- optional: ถ้า addon สำหรับ item เฉพาะ
  addon_type_id UUID REFERENCES addon_types(id),
  addon_code TEXT NOT NULL, -- snapshot
  addon_name TEXT NOT NULL, -- snapshot
  
  quantity INTEGER DEFAULT 1,
  unit_price DECIMAL(10,2) DEFAULT 0,
  total_price DECIMAL(12,2) DEFAULT 0,
  
  -- Status
  status TEXT DEFAULT 'pending', -- pending, ready, attached, completed
  
  -- Design (if needed)
  design_file_url TEXT,
  design_status TEXT, -- pending, approved
  
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- =============================================
-- 4. CHANGE REQUESTS
-- =============================================
CREATE TABLE IF NOT EXISTS change_requests (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  request_number TEXT UNIQUE NOT NULL, -- 'CR-2024-0001'
  order_id UUID REFERENCES orders(id) ON DELETE CASCADE,
  
  -- What Phase
  order_phase TEXT NOT NULL, -- 'design', 'mockup_approved', 'in_production', 'qc_complete'
  
  -- What Changed
  change_type TEXT NOT NULL, -- 'design', 'quantity', 'size', 'color', 'add_work', 'remove_work', 'other'
  description TEXT NOT NULL,
  
  -- Impact
  affected_work_items UUID[], -- array of order_work_item ids
  
  -- Cost
  base_fee DECIMAL(10,2) DEFAULT 0, -- ค่าดำเนินการ
  design_fee DECIMAL(10,2) DEFAULT 0, -- ค่าออกแบบใหม่
  rework_fee DECIMAL(10,2) DEFAULT 0, -- ค่าทำใหม่
  material_fee DECIMAL(10,2) DEFAULT 0, -- ค่าวัสดุเพิ่ม
  total_fee DECIMAL(12,2) DEFAULT 0,
  
  -- Schedule Impact
  days_delayed INTEGER DEFAULT 0,
  new_due_date DATE,
  
  -- Status
  status TEXT DEFAULT 'pending', -- pending, quoted, approved, rejected, completed
  
  -- Approval
  quoted_at TIMESTAMPTZ,
  quoted_by UUID REFERENCES user_profiles(id),
  customer_approved_at TIMESTAMPTZ,
  payment_status TEXT DEFAULT 'unpaid', -- unpaid, paid
  
  -- Attachments
  reference_files TEXT[],
  
  -- Notes
  customer_reason TEXT,
  admin_notes TEXT,
  
  created_by UUID REFERENCES user_profiles(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Change Request Logs
CREATE TABLE IF NOT EXISTS change_request_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  change_request_id UUID REFERENCES change_requests(id) ON DELETE CASCADE,
  
  action TEXT NOT NULL,
  from_status TEXT,
  to_status TEXT,
  notes TEXT,
  
  performed_by UUID REFERENCES user_profiles(id),
  performed_at TIMESTAMPTZ DEFAULT NOW()
);

-- =============================================
-- 5. APPROVAL GATES
-- =============================================
CREATE TABLE IF NOT EXISTS approval_gates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  order_id UUID REFERENCES orders(id) ON DELETE CASCADE,
  
  gate_type TEXT NOT NULL, -- 'design', 'mockup', 'material', 'production_start'
  gate_name TEXT NOT NULL,
  
  status TEXT DEFAULT 'pending', -- pending, approved, rejected
  
  -- Approval
  approved_by UUID REFERENCES user_profiles(id),
  approved_at TIMESTAMPTZ,
  
  -- Customer Confirmation (for customer-facing gates)
  customer_confirmed_at TIMESTAMPTZ,
  customer_ip TEXT,
  customer_signature TEXT, -- digital signature if needed
  
  -- Notes
  notes TEXT,
  rejection_reason TEXT,
  
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- =============================================
-- 6. UPDATES TO ORDERS TABLE
-- =============================================
ALTER TABLE orders 
ADD COLUMN IF NOT EXISTS order_type_code TEXT DEFAULT 'ready_made',
ADD COLUMN IF NOT EXISTS production_mode TEXT DEFAULT 'in_house', -- 'in_house', 'outsource', 'hybrid'
ADD COLUMN IF NOT EXISTS priority_level INTEGER DEFAULT 0, -- 0=normal, 1=rush, 2=urgent, 3=emergency
ADD COLUMN IF NOT EXISTS priority_surcharge DECIMAL(10,2) DEFAULT 0,
ADD COLUMN IF NOT EXISTS revision_count INTEGER DEFAULT 0,
ADD COLUMN IF NOT EXISTS free_revisions INTEGER DEFAULT 2,
ADD COLUMN IF NOT EXISTS change_request_count INTEGER DEFAULT 0,
ADD COLUMN IF NOT EXISTS change_request_total DECIMAL(12,2) DEFAULT 0,
ADD COLUMN IF NOT EXISTS all_designs_approved BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS mockup_approved BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS mockup_approved_at TIMESTAMPTZ,
ADD COLUMN IF NOT EXISTS materials_ready BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS production_unlocked BOOLEAN DEFAULT false;

-- =============================================
-- 7. QC IMPROVEMENTS
-- =============================================
CREATE TABLE IF NOT EXISTS qc_stages (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  name_th TEXT NOT NULL,
  stage_order INTEGER DEFAULT 0,
  is_mandatory BOOLEAN DEFAULT true,
  applies_to TEXT[], -- work type codes this stage applies to
  created_at TIMESTAMPTZ DEFAULT NOW()
);

INSERT INTO qc_stages (code, name, name_th, stage_order, applies_to) VALUES
('material', 'Material QC', 'ตรวจวัตถุดิบ', 1, ARRAY['cutting', 'sewing']),
('pre_production', 'Pre-Production QC', 'ตรวจก่อนผลิต', 2, NULL),
('in_process', 'In-Process QC', 'ตรวจระหว่างผลิต', 3, NULL),
('post_production', 'Post-Production QC', 'ตรวจหลังผลิต', 4, NULL),
('final', 'Final QC', 'ตรวจก่อนส่ง', 5, NULL);

-- QC Records (detailed per item)
CREATE TABLE IF NOT EXISTS qc_records (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  job_id UUID REFERENCES production_jobs(id) ON DELETE CASCADE,
  qc_stage_code TEXT NOT NULL,
  
  -- Quantities
  checked_qty INTEGER NOT NULL,
  passed_qty INTEGER DEFAULT 0,
  failed_qty INTEGER DEFAULT 0,
  
  -- Result
  overall_result TEXT, -- 'pass', 'fail', 'partial'
  
  -- Checklist Results
  checklist_results JSONB, -- {checkpoint_code: {passed: bool, notes: text, photo_url: text}}
  
  -- Evidence
  photo_urls TEXT[],
  
  -- Notes
  notes TEXT,
  failure_reasons TEXT[],
  
  checked_by UUID REFERENCES user_profiles(id),
  checked_at TIMESTAMPTZ DEFAULT NOW()
);

-- =============================================
-- 8. REVISION TRACKING
-- =============================================
-- Improve design_versions table
ALTER TABLE design_versions
ADD COLUMN IF NOT EXISTS revision_type TEXT DEFAULT 'free', -- 'free', 'paid'
ADD COLUMN IF NOT EXISTS revision_cost DECIMAL(10,2) DEFAULT 0,
ADD COLUMN IF NOT EXISTS change_description TEXT,
ADD COLUMN IF NOT EXISTS approved_by_customer BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS customer_approved_at TIMESTAMPTZ;

-- =============================================
-- INDEXES
-- =============================================
CREATE INDEX IF NOT EXISTS idx_order_addons_order_id ON order_addons(order_id);
CREATE INDEX IF NOT EXISTS idx_change_requests_order_id ON change_requests(order_id);
CREATE INDEX IF NOT EXISTS idx_change_requests_status ON change_requests(status);
CREATE INDEX IF NOT EXISTS idx_approval_gates_order_id ON approval_gates(order_id);
CREATE INDEX IF NOT EXISTS idx_qc_records_job_id ON qc_records(job_id);

-- =============================================
-- RLS POLICIES
-- =============================================
ALTER TABLE addon_types ENABLE ROW LEVEL SECURITY;
ALTER TABLE order_addons ENABLE ROW LEVEL SECURITY;
ALTER TABLE change_requests ENABLE ROW LEVEL SECURITY;
ALTER TABLE change_request_logs ENABLE ROW LEVEL SECURITY;
ALTER TABLE approval_gates ENABLE ROW LEVEL SECURITY;
ALTER TABLE qc_records ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Authenticated users can view addon_types" ON addon_types
  FOR SELECT USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can manage order_addons" ON order_addons
  FOR ALL USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can manage change_requests" ON change_requests
  FOR ALL USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can manage change_request_logs" ON change_request_logs
  FOR ALL USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can manage approval_gates" ON approval_gates
  FOR ALL USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can manage qc_records" ON qc_records
  FOR ALL USING (auth.role() = 'authenticated');
```

---

## 🗓️ Implementation Roadmap

### Phase 1: Core Schema Updates (สัปดาห์ 1-2)
- [ ] Run new schema migrations
- [ ] Update Prisma schema
- [ ] Create seed data for addon_types, work_dependencies
- [ ] Update existing orders with new fields

### Phase 2: Order Creation Redesign (สัปดาห์ 2-4)
- [ ] New order creation wizard UI
- [ ] Order type selection
- [ ] Work item builder with dependencies
- [ ] Addon selection interface
- [ ] Price calculation with addons & priority

### Phase 3: Design & Approval System (สัปดาห์ 4-6)
- [ ] Design version tracking UI
- [ ] Revision counter with cost
- [ ] Mockup creation & approval flow
- [ ] Approval gates implementation
- [ ] Customer portal updates

### Phase 4: Change Request System (สัปดาห์ 6-8)
- [ ] Change request form
- [ ] Auto cost calculation
- [ ] Change history display
- [ ] Admin approval workflow
- [ ] Payment integration

### Phase 5: Production Improvements (สัปดาห์ 8-10)
- [ ] Production queue with dependencies
- [ ] Priority scoring algorithm
- [ ] Multi-stage QC interface
- [ ] Rework tracking
- [ ] Assembly station for addons

### Phase 6: Testing & Refinement (สัปดาห์ 10-12)
- [ ] End-to-end testing
- [ ] Performance optimization
- [ ] User training materials
- [ ] Go-live preparation

---

## 📊 Summary: What's New

| Feature | Before | After |
|---------|--------|-------|
| Order Types | ไม่แยก | 4 ประเภท (Ready-made, Custom, Full Custom, Print Only) |
| Work Dependencies | ไม่มี | Auto-calculate order based on rules |
| Addons | รวมกับ work items | แยกเป็นระบบ ง่ายต่อการจัดการ |
| Revisions | ไม่ limit | Free 2 ครั้ง, หลังจากนั้นคิดเงิน |
| Change Requests | ไม่มี workflow | Full workflow with cost tracking |
| Approval Gates | ไม่มี | 3 gates บังคับก่อนผลิต |
| QC | 1 stage | 5 stages with detailed checklists |
| Priority | ไม่มี | 4 levels with auto-queue sorting |

---

*Last Updated: December 2024*
*Version: 2.0 - Complete Factory ERP Redesign*

