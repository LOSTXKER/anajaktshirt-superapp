# 📱 Customer Order Page (หน้าลูกค้าดูออเดอร์)

## 🎯 วัตถุประสงค์

หน้าเว็บสำหรับลูกค้า (ไม่ต้อง Login) เพื่อ:
1. ✅ ดูสถานะออเดอร์
2. ✅ ตรวจสอบรายการสินค้า/ราคา
3. ✅ ดู/อนุมัติ Mockup
4. ✅ ชำระเงิน
5. ✅ ดาวน์โหลดเอกสาร (ใบเสนอราคา/ใบเสร็จ)
6. ✅ ติดต่อแอดมิน

---

## 🔗 Access Methods

### วิธีที่ 1: ลิงก์ตรง (แนะนำ)
```
https://anajak.com/order/ABC123XYZ

โดยที่ ABC123XYZ = Order Token (สุ่มไม่ซ้ำ)
```

### วิธีที่ 2: ค้นหาด้วยเลข Order + เบอร์โทร
```
https://anajak.com/track

┌─────────────────────────────────────────┐
│  🔍 ตรวจสอบสถานะออเดอร์                  │
├─────────────────────────────────────────┤
│                                         │
│  เลขออเดอร์: [ORD-2024-1234    ]        │
│                                         │
│  เบอร์โทร:   [0812345678       ]        │
│                                         │
│            [🔍 ค้นหา]                   │
│                                         │
└─────────────────────────────────────────┘
```

---

## 📱 UI Design

### หน้าหลัก - Order Status
```
┌─────────────────────────────────────────────────────────────────┐
│                    �icing ANAJAK                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  📦 Order #ORD-2024-1234                                        │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  👤 คุณสมชาย ใจดี                                                │
│  📅 วันที่สั่ง: 15 ธ.ค. 2567                                      │
│  📅 กำหนดส่ง: 25 ธ.ค. 2567                                       │
│                                                                  │
│  ═══════════════════════════════════════════════════════════════│
│                                                                  │
│  📊 สถานะปัจจุบัน                                                 │
│                                                                  │
│  ○────●────○────○────○────○────○                                │
│  รับ    เสนอ   ชำระ   ออกแบบ  ผลิต   QC    ส่ง                   │
│  ออเดอร์ ราคา   เงิน                                             │
│                                                                  │
│  🟢 กำลังเสนอราคา                                                │
│  อัพเดทล่าสุด: 16 ธ.ค. 2567 14:30                                │
│                                                                  │
│  ═══════════════════════════════════════════════════════════════│
│                                                                  │
│  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐       │
│  │ 📋        │ │ 🎨        │ │ 💳        │ │ 📄        │       │
│  │ รายการ    │ │ Mockup    │ │ ชำระเงิน  │ │ เอกสาร    │       │
│  └───────────┘ └───────────┘ └───────────┘ └───────────┘       │
│                                                                  │
│  ═══════════════════════════════════════════════════════════════│
│                                                                  │
│  💬 มีคำถาม? [ติดต่อแอดมิน via LINE]                             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Tab: รายการสินค้า
```
┌─────────────────────────────────────────────────────────────────┐
│  📋 รายการสินค้า                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 1. งาน DTG - เสื้อยืด Cotton สีขาว                       │    │
│  │    ──────────────────────────────────────────────────── │    │
│  │    Size    จำนวน    ราคา/ตัว    รวม                     │    │
│  │    S       10       285        2,850                   │    │
│  │    M       30       285        8,550                   │    │
│  │    L       40       285        11,400                  │    │
│  │    XL      15       295        4,425                   │    │
│  │    2XL     5        305        1,525                   │    │
│  │    ──────────────────────────────────────────────────── │    │
│  │    รวม 100 ตัว                          28,750 บาท     │    │
│  │                                                         │    │
│  │    🖨️ พิมพ์: หน้า A4, หลัง A5                           │    │
│  │    ค่าพิมพ์: 100 x 180 = 18,000 บาท                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 2. ป้ายทอติดคอ                                          │    │
│  │    100 ชิ้น x 8 บาท = 800 บาท                          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ═══════════════════════════════════════════════════════════════│
│                                                                  │
│  ยอดสินค้า:                              47,550 บาท            │
│  ค่าจัดส่ง:                                 150 บาท            │
│  ───────────────────────────────────────────────────            │
│  💰 ยอดรวมทั้งสิ้น:                       47,700 บาท            │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 💳 สถานะการชำระเงิน                                     │    │
│  │                                                         │    │
│  │ งวดที่ 1 (50%): ✅ ชำระแล้ว 23,850 บาท                  │    │
│  │ งวดที่ 2 (50%): ⏳ รอชำระ 23,850 บาท                    │    │
│  │                                                         │    │
│  │              [💳 ชำระเงินงวดที่ 2]                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Tab: Mockup (ดู/อนุมัติ)
```
┌─────────────────────────────────────────────────────────────────┐
│  🎨 Mockup                                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                         │    │
│  │   ┌───────────────┐    ┌───────────────┐               │    │
│  │   │               │    │               │               │    │
│  │   │   [รูปหน้า]   │    │   [รูปหลัง]   │               │    │
│  │   │               │    │               │               │    │
│  │   └───────────────┘    └───────────────┘               │    │
│  │        หน้า                  หลัง                       │    │
│  │                                                         │    │
│  │   (คลิกเพื่อขยาย)                                       │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  📝 Version: 2 (อัพเดท 17 ธ.ค. 14:30)                           │
│                                                                  │
│  ⚠️ กรุณาตรวจสอบ Mockup ให้ละเอียด:                             │
│  • ตำแหน่งลาย                                                    │
│  • ขนาดลาย                                                       │
│  • สีลาย                                                         │
│  • ความถูกต้องของข้อความ                                         │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  💬 Comment (ถ้ามี):                                             │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                         │    │
│  │  พิมพ์ข้อความที่นี่...                                    │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌──────────────────┐        ┌──────────────────┐              │
│  │  ❌ ขอแก้ไข      │        │  ✅ อนุมัติ       │              │
│  └──────────────────┘        └──────────────────┘              │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  📜 ประวัติ Mockup:                                              │
│  • V1 (15 ธ.ค.): ❌ ขอแก้ไข - "ตัวหนังสือเล็กไป"                 │
│  • V2 (17 ธ.ค.): ⏳ รอตรวจสอบ                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Tab: ชำระเงิน
```
┌─────────────────────────────────────────────────────────────────┐
│  💳 ชำระเงิน                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  💰 ยอดที่ต้องชำระ: 23,850 บาท                                  │
│  (งวดที่ 2 - หลังอนุมัติ Mockup)                                 │
│                                                                  │
│  ═══════════════════════════════════════════════════════════════│
│                                                                  │
│  📱 วิธีชำระเงิน:                                                │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  🏦 โอนเงิน                                             │    │
│  │                                                         │    │
│  │  ธนาคารกสิกรไทย                                         │    │
│  │  เลขบัญชี: 123-4-56789-0                                │    │
│  │  ชื่อบัญชี: บริษัท อนาจักร จำกัด                         │    │
│  │                                                         │    │
│  │  [📋 คัดลอกเลขบัญชี]                                    │    │
│  │                                                         │    │
│  │  ─────────────────────────────────────────────────────  │    │
│  │                                                         │    │
│  │  📤 อัพโหลดสลิป:                                        │    │
│  │  ┌─────────────────────────────────────────────────┐   │    │
│  │  │                                                 │   │    │
│  │  │     [📷 คลิกเพื่ออัพโหลดสลิป]                    │   │    │
│  │  │                                                 │   │    │
│  │  └─────────────────────────────────────────────────┘   │    │
│  │                                                         │    │
│  │  💬 หมายเหตุ (ถ้ามี):                                   │    │
│  │  [____________________________________]                │    │
│  │                                                         │    │
│  │               [📤 ส่งหลักฐานการชำระเงิน]                │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  📜 ประวัติการชำระเงิน:                                          │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ ✅ งวดที่ 1 - 15 ธ.ค. 2567                              │    │
│  │    ยอด: 23,850 บาท                                     │    │
│  │    [ดูสลิป]                                             │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Tab: เอกสาร
```
┌─────────────────────────────────────────────────────────────────┐
│  📄 เอกสาร                                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 📋 ใบเสนอราคา                                           │    │
│  │ QT-2024-1234 | 15 ธ.ค. 2567                            │    │
│  │ [📥 ดาวน์โหลด PDF]                                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 🧾 ใบแจ้งหนี้ งวดที่ 1                                   │    │
│  │ INV-2024-1234-1 | 15 ธ.ค. 2567                         │    │
│  │ [📥 ดาวน์โหลด PDF]                                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ ✅ ใบเสร็จรับเงิน งวดที่ 1                               │    │
│  │ REC-2024-1234-1 | 15 ธ.ค. 2567                         │    │
│  │ [📥 ดาวน์โหลด PDF]                                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ ⏳ ใบแจ้งหนี้ งวดที่ 2                                   │    │
│  │ INV-2024-1234-2 | รอชำระเงิน                           │    │
│  │ [📥 ดาวน์โหลด PDF]                                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  🧾 ต้องการใบกำกับภาษี?                                         │
│  [📝 กรอกข้อมูลขอใบกำกับภาษี]                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📱 Mobile Responsive

```
┌─────────────────────┐
│  📦 ORD-2024-1234   │
│  ───────────────────│
│                     │
│  🟢 กำลังผลิต       │
│  ▓▓▓▓▓▓░░░░ 60%    │
│                     │
│  Due: 25 ธ.ค.       │
│                     │
│  ═══════════════════│
│                     │
│  [📋 รายการ]        │
│                     │
│  [🎨 Mockup]        │
│  ⚠️ รออนุมัติ       │
│                     │
│  [💳 ชำระเงิน]      │
│  💰 ค้าง 23,850 บาท │
│                     │
│  [📄 เอกสาร]        │
│                     │
│  ═══════════════════│
│                     │
│  [💬 ติดต่อ LINE]   │
│                     │
└─────────────────────┘
```

---

## 🔐 Security

### Order Token
```javascript
// สร้าง unique token สำหรับแต่ละ order
const token = crypto.randomBytes(16).toString('hex');
// ผลลัพธ์: "a1b2c3d4e5f6g7h8"

// URL: /order/a1b2c3d4e5f6g7h8
// ไม่สามารถเดาได้
```

### Access Control
```
✅ สิ่งที่ลูกค้าทำได้:
├── ดูข้อมูล Order (อ่านอย่างเดียว)
├── ดู/อนุมัติ Mockup
├── อัพโหลดสลิปชำระเงิน
├── ดาวน์โหลดเอกสาร
├── เพิ่ม Comment
└── ติดต่อแอดมิน

❌ สิ่งที่ลูกค้าทำไม่ได้:
├── แก้ไขรายการ (ต้องติดต่อแอดมิน)
├── ดู Order คนอื่น
├── เข้าระบบหลังบ้าน
└── ดูข้อมูลต้นทุน/กำไร
```

---

## 🔔 Notifications

### แจ้งเตือนลูกค้าอัตโนมัติ (LINE/Email)
```
📱 LINE Messages:

1️⃣ เมื่อสร้าง Order:
"สวัสดีค่ะ คุณสมชาย
ออเดอร์ #ORD-2024-1234 ของคุณได้รับแล้ว
ดูรายละเอียด: https://anajak.com/order/abc123"

2️⃣ เมื่อมี Mockup ใหม่:
"Mockup พร้อมให้ตรวจสอบแล้วค่ะ
กรุณาตรวจสอบและอนุมัติ: https://anajak.com/order/abc123"

3️⃣ เมื่อเริ่มผลิต:
"ออเดอร์ของคุณเริ่มผลิตแล้วค่ะ 🎉
กำหนดส่ง: 25 ธ.ค. 2567"

4️⃣ เมื่อผลิตเสร็จ:
"ออเดอร์ผลิตเสร็จแล้วค่ะ ✅
รอชำระเงินงวดสุดท้าย 23,850 บาท"

5️⃣ เมื่อจัดส่ง:
"ส่งของแล้วค่ะ 📦
Tracking: KERRY1234567890
ติดตามพัสดุ: https://track.th"
```

---

## 📊 Database Schema

```sql
-- Order Access Tokens
CREATE TABLE order_access_tokens (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  order_id UUID REFERENCES orders(id) ON DELETE CASCADE,
  token TEXT UNIQUE NOT NULL,
  
  -- Security
  is_active BOOLEAN DEFAULT true,
  expires_at TIMESTAMPTZ, -- null = never expires
  
  -- Usage tracking
  last_accessed_at TIMESTAMPTZ,
  access_count INTEGER DEFAULT 0,
  
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Customer Actions Log (บันทึกสิ่งที่ลูกค้าทำ)
CREATE TABLE customer_order_actions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  order_id UUID REFERENCES orders(id),
  
  action_type TEXT NOT NULL,
  -- 'view', 'mockup_approve', 'mockup_reject', 
  -- 'payment_submit', 'comment', 'download_doc'
  
  action_data JSONB,
  ip_address TEXT,
  user_agent TEXT,
  
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Index
CREATE INDEX idx_order_tokens ON order_access_tokens(token);
CREATE INDEX idx_order_tokens_order ON order_access_tokens(order_id);
```

---

## 🛠️ Routes

```
/order/[token]           - หน้าหลัก (Status)
/order/[token]/items     - รายการสินค้า
/order/[token]/mockup    - ดู/อนุมัติ Mockup
/order/[token]/payment   - ชำระเงิน
/order/[token]/documents - เอกสาร

/track                   - ค้นหา Order
```

---

*Document Created: December 2024*

